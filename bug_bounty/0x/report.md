# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [High Issues](#high-issues)
  - [H-1: Arbitrary `from` passed to `transferFrom` (or `safeTransferFrom`)](#h-1-arbitrary-from-passed-to-transferfrom-or-safetransferfrom)
- [Medium Issues](#medium-issues)
  - [M-1: Centralization Risk for trusted owners](#m-1-centralization-risk-for-trusted-owners)
- [Low Issues](#low-issues)
  - [L-1: `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`](#l-1-abiencodepacked-should-not-be-used-with-dynamic-types-when-passing-the-result-to-a-hash-function-such-as-keccak256)
  - [L-2: `ecrecover` is susceptible to signature malleability](#l-2-ecrecover-is-susceptible-to-signature-malleability)
  - [L-3: Unsafe ERC20 Operations should not be used](#l-3-unsafe-erc20-operations-should-not-be-used)
  - [L-4: Solidity pragma should be specific, not wide](#l-4-solidity-pragma-should-be-specific-not-wide)
  - [L-5: Conditional storage checks are not consistent](#l-5-conditional-storage-checks-are-not-consistent)
  - [L-6: PUSH0 is not supported by all chains](#l-6-push0-is-not-supported-by-all-chains)
- [NC Issues](#nc-issues)
  - [NC-1: Functions not used internally could be marked external](#nc-1-functions-not-used-internally-could-be-marked-external)
  - [NC-2: Constants should be defined and used instead of literals](#nc-2-constants-should-be-defined-and-used-instead-of-literals)
  - [NC-3: Event is missing `indexed` fields](#nc-3-event-is-missing-indexed-fields)
  - [NC-4: `require()` / `revert()` statements should have descriptive reason strings or custom errors](#nc-4-require--revert-statements-should-have-descriptive-reason-strings-or-custom-errors)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 67 |
| Total nSLOC | 6082 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| src/ChainCompatibility.sol | 43 |
| src/Context.sol | 17 |
| src/IERC721Owner.sol | 4 |
| src/ISettlerActions.sol | 102 |
| src/Settler.sol | 94 |
| src/SettlerAbstract.sol | 14 |
| src/SettlerBase.sol | 127 |
| src/SettlerMetaTxn.sol | 114 |
| src/allowanceholder/AllowanceHolder.sol | 19 |
| src/allowanceholder/AllowanceHolderBase.sol | 123 |
| src/allowanceholder/AllowanceHolderContext.sol | 23 |
| src/allowanceholder/IAllowanceHolder.sol | 8 |
| src/allowanceholder/TransientStorage.sol | 14 |
| src/allowanceholder/TransientStorageBase.sol | 6 |
| src/allowanceholder/TransientStorageLayout.sol | 14 |
| src/allowanceholder/TransientStorageMock.sol | 22 |
| src/chains/IBlast.sol | 19 |
| src/core/Basic.sol | 54 |
| src/core/CurveTricrypto.sol | 150 |
| src/core/DodoV1.sol | 228 |
| src/core/DodoV2.sol | 40 |
| src/core/MakerPSM.sol | 56 |
| src/core/MaverickV2.sol | 167 |
| src/core/Permit2Payment.sol | 329 |
| src/core/Permit2PaymentAbstract.sol | 57 |
| src/core/RfqOrderSettlement.sol | 130 |
| src/core/SettlerErrors.sol | 18 |
| src/core/UniswapV2.sol | 95 |
| src/core/UniswapV3Fork.sol | 279 |
| src/core/Velodrome.sol | 133 |
| src/core/univ3forks/AerodromeSlipstream.sol | 4 |
| src/core/univ3forks/AlienBaseV3.sol | 3 |
| src/core/univ3forks/BaseX.sol | 3 |
| src/core/univ3forks/BladeSwap.sol | 4 |
| src/core/univ3forks/CamelotV3.sol | 4 |
| src/core/univ3forks/DackieSwapV3.sol | 7 |
| src/core/univ3forks/Fenix.sol | 4 |
| src/core/univ3forks/KinetixV3.sol | 3 |
| src/core/univ3forks/Lynex.sol | 4 |
| src/core/univ3forks/MetavaultV3.sol | 3 |
| src/core/univ3forks/QuickSwapV3.sol | 4 |
| src/core/univ3forks/SushiswapV3.sol | 8 |
| src/core/univ3forks/SwapBasedV3.sol | 3 |
| src/core/univ3forks/Thick.sol | 4 |
| src/core/univ3forks/Thruster.sol | 4 |
| src/core/univ3forks/VelodromeSlipstream.sol | 4 |
| src/deployer/BlastDeployer.sol | 18 |
| src/deployer/Deployer.sol | 313 |
| src/deployer/IDeployer.sol | 46 |
| src/deployer/TwoStepOwnable.sol | 155 |
| src/multicall/MultiCall.sol | 173 |
| src/multicall/MultiCall.sol | 173 |
| src/proxy/ERC1967UUPSProxy.sol | 143 |
| src/proxy/ERC1967UUPSUpgradeable.sol | 213 |
| src/utils/AddressDerivation.sol | 94 |
| src/utils/AtoI.sol | 25 |
| src/utils/CheckCall.sol | 38 |
| src/utils/Create3.sol | 100 |
| src/utils/FreeMemory.sol | 13 |
| src/utils/IPFS.sol | 91 |
| src/utils/ItoA.sol | 22 |
| src/utils/Panic.sol | 20 |
| src/utils/ProxyMultiCall.sol | 8 |
| src/utils/Revert.sol | 13 |
| src/utils/UnsafeMath.sol | 48 |
| src/vendor/FullMath.sol | 65 |
| src/vendor/SafeTransferLib.sol | 6 |
| **Total** | **6082** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| Critical | 0 |
| High | 1 |
| Medium | 1 |
| Low | 6 |
| NC | 4 |


# High Issues

## H-1: Arbitrary `from` passed to `transferFrom` (or `safeTransferFrom`)

Passing an arbitrary `from` address to `transferFrom` (or `safeTransferFrom`) can lead to loss of funds, because anyone can transfer tokens from the `from` address if an approval is made.  

- Found in src/allowanceholder/AllowanceHolderBase.sol [Line: 110](src/allowanceholder/AllowanceHolderBase.sol#L110)

	```solidity
	        IERC20(token).safeTransferFrom(owner, recipient, amount);
	```

- Found in src/core/Permit2Payment.sol [Line: 341](src/core/Permit2Payment.sol#L341)

	```solidity
	        _ALLOWANCE_HOLDER.transferFrom(token, owner, recipient, amount);
	```



# Medium Issues

## M-1: Centralization Risk for trusted owners

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

- Found in src/deployer/Deployer.sol [Line: 195](src/deployer/Deployer.sol#L195)

	```solidity
	    function authorize(Feature feature, address auth, uint40 deadline) external override onlyOwner returns (bool) {
	```

- Found in src/deployer/Deployer.sol [Line: 223](src/deployer/Deployer.sol#L223)

	```solidity
	        onlyOwner
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 104](src/deployer/TwoStepOwnable.sol#L104)

	```solidity
	    function renounceOwnership() public virtual override onlyOwner returns (bool) {
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 109](src/deployer/TwoStepOwnable.sol#L109)

	```solidity
	    function transferOwnership(address newOwner) public virtual override onlyOwner returns (bool) {
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 167](src/deployer/TwoStepOwnable.sol#L167)

	```solidity
	    function renounceOwnership() public virtual override onlyOwner returns (bool) {
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 175](src/deployer/TwoStepOwnable.sol#L175)

	```solidity
	    function transferOwnership(address newOwner) public virtual override onlyOwner returns (bool) {
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 205](src/proxy/ERC1967UUPSUpgradeable.sol#L205)

	```solidity
	    function upgrade(address newImplementation) public payable virtual override onlyOwner returns (bool) {
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 222](src/proxy/ERC1967UUPSUpgradeable.sol#L222)

	```solidity
	        onlyOwner
	```



# Low Issues

## L-1: `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`

Use `abi.encode()` instead which will pad items to 32 bytes, which will [prevent hash collisions](https://docs.soliditylang.org/en/v0.8.13/abi-spec.html#non-standard-packed-mode) (e.g. `abi.encodePacked(0x123,0x456)` => `0x123456` => `abi.encodePacked(0x1,0x23456)`, but `abi.encode(0x123,0x456)` => `0x0...1230...456`). Unless there is a compelling reason, `abi.encode` should be preferred. If there is only one argument to `abi.encodePacked()` it can often be cast to `bytes()` or `bytes32()` [instead](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739).
If all arguments are strings and or bytes, `bytes.concat()` should be used instead.

- Found in src/core/Permit2Payment.sol [Line: 375](src/core/Permit2Payment.sol#L375)

	```solidity
	        abi.encodePacked("SlippageAndActions slippageAndActions)", SLIPPAGE_AND_ACTIONS_TYPE, TOKEN_PERMISSIONS_TYPE)
	```

- Found in src/core/RfqOrderSettlement.sol [Line: 26](src/core/RfqOrderSettlement.sol#L26)

	```solidity
	        string(abi.encodePacked("Consideration consideration)", CONSIDERATION_TYPE, TOKEN_PERMISSIONS_TYPE));
	```

- Found in src/core/RfqOrderSettlement.sol [Line: 32](src/core/RfqOrderSettlement.sol#L32)

	```solidity
	    string internal constant RFQ_ORDER_TYPE_RECURSIVE = string(abi.encodePacked(RFQ_ORDER_TYPE, CONSIDERATION_TYPE));
	```

- Found in src/proxy/ERC1967UUPSProxy.sol [Line: 292](src/proxy/ERC1967UUPSProxy.sol#L292)

	```solidity
	        return abi.encodePacked(_INITCODE, implementation, initializer);
	```

- Found in src/proxy/ERC1967UUPSProxy.sol [Line: 300](src/proxy/ERC1967UUPSProxy.sol#L300)

	```solidity
	        return abi.encodePacked(_INITCODE_LONDON, implementation, initializer);
	```



## L-2: `ecrecover` is susceptible to signature malleability

The `ecrecover` function is susceptible to signature malleability. This means that the same message can be signed in multiple ways, allowing an attacker to change the message signature without invalidating it. This can lead to unexpected behavior in smart contracts, such as the loss of funds or the ability to bypass access control. Consider using OpenZeppelin's ECDSA library instead of the built-in function.

- Found in src/utils/AddressDerivation.sol [Line: 39](src/utils/AddressDerivation.sol#L39)

	```solidity
	            return ecrecover(
	```



## L-3: Unsafe ERC20 Operations should not be used

ERC20 functions may not behave as expected. For example: return values are not always meaningful. It is recommended to use OpenZeppelin's SafeERC20 library.

- Found in src/allowanceholder/AllowanceHolderBase.sol [Line: 118](src/allowanceholder/AllowanceHolderBase.sol#L118)

	```solidity
	        if (selector == uint256(uint32(IAllowanceHolder.transferFrom.selector))) {
	```

- Found in src/core/Permit2Payment.sol [Line: 341](src/core/Permit2Payment.sol#L341)

	```solidity
	        _ALLOWANCE_HOLDER.transferFrom(token, owner, recipient, amount);
	```



## L-4: Solidity pragma should be specific, not wide

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

- Found in src/ChainCompatibility.sol [Line: 2](src/ChainCompatibility.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/Context.sol [Line: 2](src/Context.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/IERC721Owner.sol [Line: 2](src/IERC721Owner.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/ISettlerActions.sol [Line: 2](src/ISettlerActions.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/Settler.sol [Line: 2](src/Settler.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/SettlerAbstract.sol [Line: 2](src/SettlerAbstract.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/SettlerBase.sol [Line: 2](src/SettlerBase.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/SettlerMetaTxn.sol [Line: 2](src/SettlerMetaTxn.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/AllowanceHolderBase.sol [Line: 2](src/allowanceholder/AllowanceHolderBase.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/AllowanceHolderContext.sol [Line: 2](src/allowanceholder/AllowanceHolderContext.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/IAllowanceHolder.sol [Line: 2](src/allowanceholder/IAllowanceHolder.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/TransientStorage.sol [Line: 2](src/allowanceholder/TransientStorage.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/TransientStorageBase.sol [Line: 2](src/allowanceholder/TransientStorageBase.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/TransientStorageLayout.sol [Line: 2](src/allowanceholder/TransientStorageLayout.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/TransientStorageMock.sol [Line: 2](src/allowanceholder/TransientStorageMock.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/chains/IBlast.sol [Line: 2](src/chains/IBlast.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/Basic.sol [Line: 2](src/core/Basic.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/CurveTricrypto.sol [Line: 2](src/core/CurveTricrypto.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/DodoV1.sol [Line: 2](src/core/DodoV1.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/DodoV2.sol [Line: 2](src/core/DodoV2.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/MakerPSM.sol [Line: 2](src/core/MakerPSM.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/MaverickV2.sol [Line: 2](src/core/MaverickV2.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/Permit2Payment.sol [Line: 2](src/core/Permit2Payment.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/Permit2PaymentAbstract.sol [Line: 2](src/core/Permit2PaymentAbstract.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/RfqOrderSettlement.sol [Line: 2](src/core/RfqOrderSettlement.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/SettlerErrors.sol [Line: 2](src/core/SettlerErrors.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/UniswapV2.sol [Line: 2](src/core/UniswapV2.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/UniswapV3Fork.sol [Line: 2](src/core/UniswapV3Fork.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/Velodrome.sol [Line: 2](src/core/Velodrome.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/AerodromeSlipstream.sol [Line: 2](src/core/univ3forks/AerodromeSlipstream.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/AlienBaseV3.sol [Line: 2](src/core/univ3forks/AlienBaseV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/BaseX.sol [Line: 2](src/core/univ3forks/BaseX.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/BladeSwap.sol [Line: 2](src/core/univ3forks/BladeSwap.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/CamelotV3.sol [Line: 2](src/core/univ3forks/CamelotV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/DackieSwapV3.sol [Line: 2](src/core/univ3forks/DackieSwapV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/Fenix.sol [Line: 2](src/core/univ3forks/Fenix.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/KinetixV3.sol [Line: 2](src/core/univ3forks/KinetixV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/Lynex.sol [Line: 2](src/core/univ3forks/Lynex.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/MetavaultV3.sol [Line: 2](src/core/univ3forks/MetavaultV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/QuickSwapV3.sol [Line: 2](src/core/univ3forks/QuickSwapV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/SushiswapV3.sol [Line: 2](src/core/univ3forks/SushiswapV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/SwapBasedV3.sol [Line: 2](src/core/univ3forks/SwapBasedV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/Thick.sol [Line: 2](src/core/univ3forks/Thick.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/Thruster.sol [Line: 2](src/core/univ3forks/Thruster.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/VelodromeSlipstream.sol [Line: 2](src/core/univ3forks/VelodromeSlipstream.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/deployer/IDeployer.sol [Line: 2](src/deployer/IDeployer.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 2](src/deployer/TwoStepOwnable.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/proxy/ERC1967UUPSProxy.sol [Line: 2](src/proxy/ERC1967UUPSProxy.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/AddressDerivation.sol [Line: 2](src/utils/AddressDerivation.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/AtoI.sol [Line: 2](src/utils/AtoI.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/CheckCall.sol [Line: 2](src/utils/CheckCall.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/Create3.sol [Line: 2](src/utils/Create3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/FreeMemory.sol [Line: 2](src/utils/FreeMemory.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/IPFS.sol [Line: 2](src/utils/IPFS.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/ItoA.sol [Line: 2](src/utils/ItoA.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/Panic.sol [Line: 2](src/utils/Panic.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/ProxyMultiCall.sol [Line: 2](src/utils/ProxyMultiCall.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/Revert.sol [Line: 2](src/utils/Revert.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/UnsafeMath.sol [Line: 2](src/utils/UnsafeMath.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/vendor/FullMath.sol [Line: 2](src/vendor/FullMath.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/vendor/SafeTransferLib.sol [Line: 2](src/vendor/SafeTransferLib.sol#L2)

	```solidity
	pragma solidity >=0.8.25;
	```



## L-5: Conditional storage checks are not consistent

When writing `require` or `if` conditionals that check storage values, it is important to be consistent to prevent off-by-one errors. There are instances found where the same storage variable is checked multiple times, but the conditionals are not consistent.

- Found in src/core/DodoV1.sol [Line: 64](src/core/DodoV1.sol#L64)

	```solidity
	            return target * d / ONE;
	```

- Found in src/core/DodoV1.sol [Line: 76](src/core/DodoV1.sol#L76)

	```solidity
	            return target * ONE / d;
	```

- Found in src/core/DodoV1.sol [Line: 82](src/core/DodoV1.sol#L82)

	```solidity
	            return (target * ONE).divCeil(d);
	```

- Found in src/core/UniswapV3Fork.sol [Line: 221](src/core/UniswapV3Fork.sol#L221)

	```solidity
	        return encodedPath.length > SINGLE_HOP_PATH_SIZE;
	```

- Found in src/core/UniswapV3Fork.sol [Line: 229](src/core/UniswapV3Fork.sol#L229)

	```solidity
	        if (encodedPath.length < SINGLE_HOP_PATH_SIZE) {
	```

- Found in src/core/Velodrome.sol [Line: 36](src/core/Velodrome.sol#L36)

	```solidity
	            return _k(x, y, x * x / _BASIS);
	```

- Found in src/core/Velodrome.sol [Line: 42](src/core/Velodrome.sol#L42)

	```solidity
	            return _k(x, y, x_squared, y * y / _BASIS);
	```

- Found in src/core/Velodrome.sol [Line: 48](src/core/Velodrome.sol#L48)

	```solidity
	            return x * y / _BASIS * (x_squared + y_squared) / _BASIS;
	```

- Found in src/core/Velodrome.sol [Line: 56](src/core/Velodrome.sol#L56)

	```solidity
	            return _d(y, three_x0, x0_cubed, y * y / _BASIS);
	```

- Found in src/core/Velodrome.sol [Line: 62](src/core/Velodrome.sol#L62)

	```solidity
	            return y_squared * three_x0 / _BASIS + x0_cubed;
	```

- Found in src/core/Velodrome.sol [Line: 73](src/core/Velodrome.sol#L73)

	```solidity
	            uint256 x0_squared = x0 * x0 / _BASIS;
	```

- Found in src/core/Velodrome.sol [Line: 74](src/core/Velodrome.sol#L74)

	```solidity
	            uint256 x0_cubed = x0_squared * x0 / _BASIS;
	```

- Found in src/core/Velodrome.sol [Line: 76](src/core/Velodrome.sol#L76)

	```solidity
	                uint256 y_squared = y * y / _BASIS;
	```

- Found in src/core/Velodrome.sol [Line: 165](src/core/Velodrome.sol#L165)

	```solidity
	            sellReserve = (sellReserve * _BASIS).unsafeDiv(sellBasis);
	```

- Found in src/core/Velodrome.sol [Line: 173](src/core/Velodrome.sol#L173)

	```solidity
	            buyAmount = buyAmount * buyBasis / _BASIS;
	```

- Found in src/deployer/Deployer.sol [Line: 153](src/deployer/Deployer.sol#L153)

	```solidity
	        if (_implVersion == 1) {
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 99](src/proxy/ERC1967UUPSUpgradeable.sol#L99)

	```solidity
	        if (newVersion >= type(uint256).max - _MAX_VERSION_INCREASE) {
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 149](src/proxy/ERC1967UUPSUpgradeable.sol#L149)

	```solidity
	        if (_storageVersion() + 1 != _implVersion) {
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 193](src/proxy/ERC1967UUPSUpgradeable.sol#L193)

	```solidity
	                if (storageVersion - implVersion > _MAX_VERSION_INCREASE) {
	```



## L-6: PUSH0 is not supported by all chains

Solc compiler version 0.8.20 switches the default target EVM version to Shanghai, which means that the generated bytecode will include PUSH0 opcodes. Be sure to select the appropriate EVM version in case you intend to deploy on a chain other than mainnet like L2 chains that may not support PUSH0, otherwise deployment of your contracts will fail.

- Found in src/ChainCompatibility.sol [Line: 2](src/ChainCompatibility.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/Context.sol [Line: 2](src/Context.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/IERC721Owner.sol [Line: 2](src/IERC721Owner.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/ISettlerActions.sol [Line: 2](src/ISettlerActions.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/Settler.sol [Line: 2](src/Settler.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/SettlerAbstract.sol [Line: 2](src/SettlerAbstract.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/SettlerBase.sol [Line: 2](src/SettlerBase.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/SettlerMetaTxn.sol [Line: 2](src/SettlerMetaTxn.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/AllowanceHolderBase.sol [Line: 2](src/allowanceholder/AllowanceHolderBase.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/AllowanceHolderContext.sol [Line: 2](src/allowanceholder/AllowanceHolderContext.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/IAllowanceHolder.sol [Line: 2](src/allowanceholder/IAllowanceHolder.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/TransientStorage.sol [Line: 2](src/allowanceholder/TransientStorage.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/TransientStorageBase.sol [Line: 2](src/allowanceholder/TransientStorageBase.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/TransientStorageLayout.sol [Line: 2](src/allowanceholder/TransientStorageLayout.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/allowanceholder/TransientStorageMock.sol [Line: 2](src/allowanceholder/TransientStorageMock.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/chains/IBlast.sol [Line: 2](src/chains/IBlast.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/Basic.sol [Line: 2](src/core/Basic.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/CurveTricrypto.sol [Line: 2](src/core/CurveTricrypto.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/DodoV1.sol [Line: 2](src/core/DodoV1.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/DodoV2.sol [Line: 2](src/core/DodoV2.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/MakerPSM.sol [Line: 2](src/core/MakerPSM.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/MaverickV2.sol [Line: 2](src/core/MaverickV2.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/Permit2Payment.sol [Line: 2](src/core/Permit2Payment.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/Permit2PaymentAbstract.sol [Line: 2](src/core/Permit2PaymentAbstract.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/RfqOrderSettlement.sol [Line: 2](src/core/RfqOrderSettlement.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/SettlerErrors.sol [Line: 2](src/core/SettlerErrors.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/UniswapV2.sol [Line: 2](src/core/UniswapV2.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/UniswapV3Fork.sol [Line: 2](src/core/UniswapV3Fork.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/Velodrome.sol [Line: 2](src/core/Velodrome.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/AerodromeSlipstream.sol [Line: 2](src/core/univ3forks/AerodromeSlipstream.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/AlienBaseV3.sol [Line: 2](src/core/univ3forks/AlienBaseV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/BaseX.sol [Line: 2](src/core/univ3forks/BaseX.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/BladeSwap.sol [Line: 2](src/core/univ3forks/BladeSwap.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/CamelotV3.sol [Line: 2](src/core/univ3forks/CamelotV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/DackieSwapV3.sol [Line: 2](src/core/univ3forks/DackieSwapV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/Fenix.sol [Line: 2](src/core/univ3forks/Fenix.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/KinetixV3.sol [Line: 2](src/core/univ3forks/KinetixV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/Lynex.sol [Line: 2](src/core/univ3forks/Lynex.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/MetavaultV3.sol [Line: 2](src/core/univ3forks/MetavaultV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/QuickSwapV3.sol [Line: 2](src/core/univ3forks/QuickSwapV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/SushiswapV3.sol [Line: 2](src/core/univ3forks/SushiswapV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/SwapBasedV3.sol [Line: 2](src/core/univ3forks/SwapBasedV3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/Thick.sol [Line: 2](src/core/univ3forks/Thick.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/Thruster.sol [Line: 2](src/core/univ3forks/Thruster.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/core/univ3forks/VelodromeSlipstream.sol [Line: 2](src/core/univ3forks/VelodromeSlipstream.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/deployer/IDeployer.sol [Line: 2](src/deployer/IDeployer.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 2](src/deployer/TwoStepOwnable.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/proxy/ERC1967UUPSProxy.sol [Line: 2](src/proxy/ERC1967UUPSProxy.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/AddressDerivation.sol [Line: 2](src/utils/AddressDerivation.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/AtoI.sol [Line: 2](src/utils/AtoI.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/CheckCall.sol [Line: 2](src/utils/CheckCall.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/Create3.sol [Line: 2](src/utils/Create3.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/FreeMemory.sol [Line: 2](src/utils/FreeMemory.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/IPFS.sol [Line: 2](src/utils/IPFS.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/ItoA.sol [Line: 2](src/utils/ItoA.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/Panic.sol [Line: 2](src/utils/Panic.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/ProxyMultiCall.sol [Line: 2](src/utils/ProxyMultiCall.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/Revert.sol [Line: 2](src/utils/Revert.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/utils/UnsafeMath.sol [Line: 2](src/utils/UnsafeMath.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/vendor/FullMath.sol [Line: 2](src/vendor/FullMath.sol#L2)

	```solidity
	pragma solidity ^0.8.25;
	```

- Found in src/vendor/SafeTransferLib.sol [Line: 2](src/vendor/SafeTransferLib.sol#L2)

	```solidity
	pragma solidity >=0.8.25;
	```



# NC Issues

## NC-1: Functions not used internally could be marked external



- Found in src/Settler.sol [Line: 90](src/Settler.sol#L90)

	```solidity
	    function execute(AllowedSlippage calldata slippage, bytes[] calldata actions, bytes32 /* zid & affiliate */ )
	```

- Found in src/SettlerMetaTxn.sol [Line: 125](src/SettlerMetaTxn.sol#L125)

	```solidity
	    function executeMetaTxn(
	```

- Found in src/deployer/BlastDeployer.sol [Line: 18](src/deployer/BlastDeployer.sol#L18)

	```solidity
	    function initialize(address initialOwner) public override {
	```

- Found in src/deployer/Deployer.sol [Line: 151](src/deployer/Deployer.sol#L151)

	```solidity
	    function initialize(address initialOwner) public virtual {
	```

- Found in src/deployer/Deployer.sol [Line: 301](src/deployer/Deployer.sol#L301)

	```solidity
	    function supportsInterface(bytes4 interfaceId)
	```

- Found in src/deployer/Deployer.sol [Line: 367](src/deployer/Deployer.sol#L367)

	```solidity
	    function implementation() public view override(AbstractUUPSUpgradeable, ERC1967UUPSUpgradeable) returns (address) {
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 39](src/deployer/TwoStepOwnable.sol#L39)

	```solidity
	    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 85](src/deployer/TwoStepOwnable.sol#L85)

	```solidity
	    function renounceOwnership() public virtual returns (bool);
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 104](src/deployer/TwoStepOwnable.sol#L104)

	```solidity
	    function renounceOwnership() public virtual override onlyOwner returns (bool) {
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 109](src/deployer/TwoStepOwnable.sol#L109)

	```solidity
	    function transferOwnership(address newOwner) public virtual override onlyOwner returns (bool) {
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 123](src/deployer/TwoStepOwnable.sol#L123)

	```solidity
	    function pendingOwner() public view virtual returns (address);
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 167](src/deployer/TwoStepOwnable.sol#L167)

	```solidity
	    function renounceOwnership() public virtual override onlyOwner returns (bool) {
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 175](src/deployer/TwoStepOwnable.sol#L175)

	```solidity
	    function transferOwnership(address newOwner) public virtual override onlyOwner returns (bool) {
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 189](src/deployer/TwoStepOwnable.sol#L189)

	```solidity
	    function acceptOwnership() public onlyPendingOwner returns (bool) {
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 195](src/deployer/TwoStepOwnable.sol#L195)

	```solidity
	    function rejectOwnership() public onlyPendingOwner returns (bool) {
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 202](src/deployer/TwoStepOwnable.sol#L202)

	```solidity
	    function renounceOwnership() public override(OwnableImpl, TwoStepOwnableImpl) returns (bool) {
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 206](src/deployer/TwoStepOwnable.sol#L206)

	```solidity
	    function transferOwnership(address newOwner) public override(OwnableImpl, TwoStepOwnableImpl) returns (bool) {
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 116](src/proxy/ERC1967UUPSUpgradeable.sol#L116)

	```solidity
	    function version() public view virtual override returns (string memory) {
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 138](src/proxy/ERC1967UUPSUpgradeable.sol#L138)

	```solidity
	    function supportsInterface(bytes4 interfaceId) public view virtual override onlyProxy returns (bool) {
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 143](src/proxy/ERC1967UUPSUpgradeable.sol#L143)

	```solidity
	    function owner() public view virtual override onlyProxy returns (address) {
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 205](src/proxy/ERC1967UUPSUpgradeable.sol#L205)

	```solidity
	    function upgrade(address newImplementation) public payable virtual override onlyOwner returns (bool) {
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 217](src/proxy/ERC1967UUPSUpgradeable.sol#L217)

	```solidity
	    function upgradeAndCall(address newImplementation, bytes calldata data)
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 289](src/proxy/ERC1967UUPSUpgradeable.sol#L289)

	```solidity
	    function renounceOwnership() public override(OwnableImpl, TwoStepOwnableImpl) returns (bool) {
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 293](src/proxy/ERC1967UUPSUpgradeable.sol#L293)

	```solidity
	    function transferOwnership(address newOwner) public override(OwnableImpl, TwoStepOwnableImpl) returns (bool) {
	```



## NC-2: Constants should be defined and used instead of literals



- Found in src/Settler.sol [Line: 24](src/Settler.sol#L24)

	```solidity
	    constructor(bytes20 gitCommit) SettlerBase(gitCommit, 2) {}
	```

- Found in src/Settler.sol [Line: 105](src/Settler.sol#L105)

	```solidity
	        for (uint256 i = 1; i < actions.length; i = i.unsafeInc()) {
	```

- Found in src/SettlerBase.sol [Line: 61](src/SettlerBase.sol#L61)

	```solidity
	        if (block.chainid != 31337) {
	```

- Found in src/SettlerBase.sol [Line: 63](src/SettlerBase.sol#L63)

	```solidity
	            assert(IERC721Owner(0x00000000000004533Fe15556B1E086BB1A72cEae).ownerOf(tokenId) == address(this));
	```

- Found in src/SettlerMetaTxn.sol [Line: 22](src/SettlerMetaTxn.sol#L22)

	```solidity
	    constructor(bytes20 gitCommit) SettlerBase(gitCommit, 3) {}
	```

- Found in src/SettlerMetaTxn.sol [Line: 144](src/SettlerMetaTxn.sol#L144)

	```solidity
	        for (uint256 i = 1; i < actions.length; i = i.unsafeInc()) {
	```

- Found in src/allowanceholder/AllowanceHolder.sol [Line: 10](src/allowanceholder/AllowanceHolder.sol#L10)

	```solidity
	        require(address(this) == 0x0000000000001fF3684f28c67538d4D072C22734 || block.chainid == 31337);
	```

- Found in src/allowanceholder/AllowanceHolderBase.sol [Line: 25](src/allowanceholder/AllowanceHolderBase.sol#L25)

	```solidity
	        if (data.length > 0x10) {
	```

- Found in src/allowanceholder/AllowanceHolderBase.sol [Line: 26](src/allowanceholder/AllowanceHolderBase.sol#L26)

	```solidity
	            target = address(uint160(bytes20(data[0x10:])));
	```

- Found in src/allowanceholder/AllowanceHolderBase.sol [Line: 29](src/allowanceholder/AllowanceHolderBase.sol#L29)

	```solidity
	        if (target <= address(0xffff)) {
	```

- Found in src/allowanceholder/AllowanceHolderBase.sol [Line: 31](src/allowanceholder/AllowanceHolderBase.sol#L31)

	```solidity
	            target = address(0xdead);
	```

- Found in src/allowanceholder/AllowanceHolderBase.sol [Line: 34](src/allowanceholder/AllowanceHolderBase.sol#L34)

	```solidity
	        if (maybeERC20.checkCall(testData, 0x20)) revert ConfusedDeputy();
	```

- Found in src/core/Basic.sol [Line: 38](src/core/Basic.sol#L38)

	```solidity
	                if ((offset += 32) > data.length) {
	```

- Found in src/core/Basic.sol [Line: 50](src/core/Basic.sol#L50)

	```solidity
	            if ((offset += 32) > data.length) {
	```

- Found in src/core/CurveTricrypto.sol [Line: 55](src/core/CurveTricrypto.sol#L55)

	```solidity
	        uint64 factoryNonce = uint64(poolInfo >> 16);
	```

- Found in src/core/CurveTricrypto.sol [Line: 56](src/core/CurveTricrypto.sol#L56)

	```solidity
	        uint8 sellIndex = uint8(poolInfo >> 8);
	```

- Found in src/core/CurveTricrypto.sol [Line: 111](src/core/CurveTricrypto.sol#L111)

	```solidity
	        require(data.length == 0xa0);
	```

- Found in src/core/DodoV1.sol [Line: 38](src/core/DodoV1.sol#L38)

	```solidity
	                return quotient + 1;
	```

- Found in src/core/DodoV1.sol [Line: 47](src/core/DodoV1.sol#L47)

	```solidity
	            uint256 z = x / 2 + 1;
	```

- Found in src/core/DodoV1.sol [Line: 51](src/core/DodoV1.sol#L51)

	```solidity
	                z = (x / z + z) / 2;
	```

- Found in src/core/DodoV1.sol [Line: 149](src/core/DodoV1.sol#L149)

	```solidity
	            uint256 squareRoot = DecimalMath.mul((DecimalMath.ONE - k) * 4, DecimalMath.mul(k, Q0) * Q0); // 4(1-k)kQ0^2
	```

- Found in src/core/DodoV1.sol [Line: 153](src/core/DodoV1.sol#L153)

	```solidity
	            uint256 denominator = (DecimalMath.ONE - k) * 2; // 2(1-k)
	```

- Found in src/core/DodoV1.sol [Line: 182](src/core/DodoV1.sol#L182)

	```solidity
	            uint256 sqrt = DecimalMath.divCeil(DecimalMath.mul(k, fairAmount) * 4, V1);
	```

- Found in src/core/DodoV1.sol [Line: 184](src/core/DodoV1.sol#L184)

	```solidity
	            uint256 premium = DecimalMath.divCeil(sqrt - DecimalMath.ONE, k * 2);
	```

- Found in src/core/MakerPSM.sol [Line: 43](src/core/MakerPSM.sol#L43)

	```solidity
	        assert(block.chainid == 1 || block.chainid == 31337);
	```

- Found in src/core/MakerPSM.sol [Line: 60](src/core/MakerPSM.sol#L60)

	```solidity
	                uint256 buyAmount = (sellAmount * 10 ** uint256(gemToken.decimals())).unsafeDiv(feeDivisor);
	```

- Found in src/core/MaverickV2.sol [Line: 222](src/core/MaverickV2.sol#L222)

	```solidity
	        require(data.length >= 0xa0);
	```

- Found in src/core/Permit2Payment.sol [Line: 221](src/core/Permit2Payment.sol#L221)

	```solidity
	        return callback(data[4:]);
	```

- Found in src/core/UniswapV2.sol [Line: 46](src/core/UniswapV2.sol#L46)

	```solidity
	        bool zeroForOne = (swapInfo & 1) == 1; // Extract the least significant bit (bit 0)
	```

- Found in src/core/UniswapV2.sol [Line: 47](src/core/UniswapV2.sol#L47)

	```solidity
	        bool sellTokenHasFee = (swapInfo & 2) >> 1 == 1; // Extract the second least significant bit (bit 1) and shift it right
	```

- Found in src/core/UniswapV2.sol [Line: 48](src/core/UniswapV2.sol#L48)

	```solidity
	        uint256 feeBps = swapInfo >> 8;
	```

- Found in src/core/UniswapV3Fork.sol [Line: 161](src/core/UniswapV3Fork.sol#L161)

	```solidity
	                                zeroForOne ? MIN_PRICE_SQRT_RATIO + 1 : MAX_PRICE_SQRT_RATIO - 1,
	```

- Found in src/core/UniswapV3Fork.sol [Line: 183](src/core/UniswapV3Fork.sol#L183)

	```solidity
	                                zeroForOne ? MIN_PRICE_SQRT_RATIO + 1 : MAX_PRICE_SQRT_RATIO - 1,
	```

- Found in src/core/UniswapV3Fork.sol [Line: 315](src/core/UniswapV3Fork.sol#L315)

	```solidity
	        require(data.length >= 0x80);
	```

- Found in src/core/UniswapV3Fork.sol [Line: 337](src/core/UniswapV3Fork.sol#L337)

	```solidity
	        data = data[0x14:];
	```

- Found in src/core/Velodrome.sol [Line: 72](src/core/Velodrome.sol#L72)

	```solidity
	            uint256 three_x0 = 3 * x0;
	```

- Found in src/core/Velodrome.sol [Line: 75](src/core/Velodrome.sol#L75)

	```solidity
	            for (uint256 i; i < 255; i++) {
	```

- Found in src/core/Velodrome.sol [Line: 90](src/core/Velodrome.sol#L90)

	```solidity
	                        if (_k(x0, y + 1, x0_squared) > xy) {
	```

- Found in src/core/Velodrome.sol [Line: 93](src/core/Velodrome.sol#L93)

	```solidity
	                            return y + 1;
	```

- Found in src/core/Velodrome.sol [Line: 95](src/core/Velodrome.sol#L95)

	```solidity
	                        dy = 1;
	```

- Found in src/core/Velodrome.sol [Line: 101](src/core/Velodrome.sol#L101)

	```solidity
	                        if (k == xy || _k(x0, y - 1, x0_squared) < xy) {
	```

- Found in src/core/Velodrome.sol [Line: 109](src/core/Velodrome.sol#L109)

	```solidity
	                        dy = 1;
	```

- Found in src/core/Velodrome.sol [Line: 125](src/core/Velodrome.sol#L125)

	```solidity
	        bool zeroForOne = (swapInfo & 1) == 1; // Extract the least significant bit (bit 0)
	```

- Found in src/core/Velodrome.sol [Line: 126](src/core/Velodrome.sol#L126)

	```solidity
	        bool sellTokenHasFee = (swapInfo & 2) >> 1 == 1; // Extract the second least significant bit (bit 1) and shift it right
	```

- Found in src/core/Velodrome.sol [Line: 127](src/core/Velodrome.sol#L127)

	```solidity
	        uint256 feeBps = swapInfo >> 8;
	```

- Found in src/core/Velodrome.sol [Line: 162](src/core/Velodrome.sol#L162)

	```solidity
	            sellAmount -= sellAmount * feeBps / 10_000; // can't overflow
	```

- Found in src/deployer/BlastDeployer.sol [Line: 10](src/deployer/BlastDeployer.sol#L10)

	```solidity
	        assert(block.chainid == 81457);
	```

- Found in src/deployer/BlastDeployer.sol [Line: 14](src/deployer/BlastDeployer.sol#L14)

	```solidity
	            BlastDeployer(0x00000000000004533Fe15556B1E086BB1A72cEae).owner()
	```

- Found in src/deployer/BlastDeployer.sol [Line: 19](src/deployer/BlastDeployer.sol#L19)

	```solidity
	        assert(block.chainid == 81457);
	```

- Found in src/deployer/Deployer.sol [Line: 33](src/deployer/Deployer.sol#L33)

	```solidity
	    function _idx(ListElem[4294967296] storage links, Nonce i) private pure returns (ListElem storage r) {
	```

- Found in src/deployer/Deployer.sol [Line: 132](src/deployer/Deployer.sol#L132)

	```solidity
	                    == keccak256(abi.encodePacked(uint256(keccak256("ZeroExSettlerDeployer.1")) - 1))
	```

- Found in src/deployer/Deployer.sol [Line: 133](src/deployer/Deployer.sol#L133)

	```solidity
	                        & ~bytes32(uint256(0xff))
	```

- Found in src/deployer/Deployer.sol [Line: 139](src/deployer/Deployer.sol#L139)

	```solidity
	            NonceList.ListElem storage linkZero = stor1.featureInfo[wrap(1)].list.links[0];
	```

- Found in src/deployer/Deployer.sol [Line: 140](src/deployer/Deployer.sol#L140)

	```solidity
	            NonceList.ListElem storage linkOne = stor1.featureInfo[wrap(1)].list.links[1];
	```

- Found in src/deployer/Deployer.sol [Line: 147](src/deployer/Deployer.sol#L147)

	```solidity
	            assert(slotZero + 1 == slotOne);
	```

- Found in src/deployer/Deployer.sol [Line: 152](src/deployer/Deployer.sol#L152)

	```solidity
	        require(address(this) == 0x00000000000004533Fe15556B1E086BB1A72cEae || block.chainid == 31337);
	```

- Found in src/deployer/Deployer.sol [Line: 153](src/deployer/Deployer.sol#L153)

	```solidity
	        if (_implVersion == 1) {
	```

- Found in src/deployer/Deployer.sol [Line: 307](src/deployer/Deployer.sol#L307)

	```solidity
	        return super.supportsInterface(interfaceId) || interfaceId == 0x80ac58cd // regular IERC721
	```

- Found in src/deployer/Deployer.sol [Line: 322](src/deployer/Deployer.sol#L322)

	```solidity
	            return 1;
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 35](src/deployer/TwoStepOwnable.sol#L35)

	```solidity
	        assert(type(IOwnable).interfaceId == 0x7f5828d0);
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 36](src/deployer/TwoStepOwnable.sol#L36)

	```solidity
	        assert(type(IERC165).interfaceId == 0x01ffc9a7);
	```

- Found in src/deployer/TwoStepOwnable.sol [Line: 151](src/deployer/TwoStepOwnable.sol#L151)

	```solidity
	        assert(AddressSlot.unwrap(_pendingOwnerSlot()) == bytes32(uint256(1)));
	```

- Found in src/multicall/MultiCall.sol [Line: 167](src/multicall/MultiCall.sol#L167)

	```solidity
	            return x + 1;
	```

- Found in src/multicall/MultiCall.sol [Line: 221](src/multicall/MultiCall.sol#L221)

	```solidity
	        assert(address(this) == 0x000000000000175a8b9bC6d539B3708EEd92EA6c || block.chainid == 31337);
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 97](src/proxy/ERC1967UUPSUpgradeable.sol#L97)

	```solidity
	        assert(_IMPLEMENTATION_SLOT == uint256(keccak256("eip1967.proxy.implementation")) - 1);
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 98](src/proxy/ERC1967UUPSUpgradeable.sol#L98)

	```solidity
	        assert(_ROLLBACK_SLOT == uint256(keccak256("eip1967.proxy.rollback")) - 1);
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 149](src/proxy/ERC1967UUPSUpgradeable.sol#L149)

	```solidity
	        if (_storageVersion() + 1 != _implVersion) {
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 251](src/proxy/ERC1967UUPSUpgradeable.sol#L251)

	```solidity
	        assert(AddressSlot.unwrap(_ownerSlot()) == bytes32(uint256(keccak256("eip1967.proxy.admin")) - 1));
	```

- Found in src/proxy/ERC1967UUPSUpgradeable.sol [Line: 278](src/proxy/ERC1967UUPSUpgradeable.sol#L278)

	```solidity
	            AddressSlot.unwrap(_pendingOwnerSlot()) == bytes32(uint256(keccak256("eip1967.proxy.admin.pending")) - 1)
	```

- Found in src/utils/AddressDerivation.sol [Line: 32](src/utils/AddressDerivation.sol#L32)

	```solidity
	                    != x.unsafeMulMod(x, _SECP256K1_P).unsafeMulMod(x, _SECP256K1_P).unsafeAddMod(7, _SECP256K1_P)
	```

- Found in src/utils/AddressDerivation.sol [Line: 40](src/utils/AddressDerivation.sol#L40)

	```solidity
	                bytes32(0), uint8(27 + (y & 1)), bytes32(x), bytes32(UnsafeMath.unsafeMulMod(x, k, _SECP256K1_N))
	```

- Found in src/utils/AddressDerivation.sol [Line: 58](src/utils/AddressDerivation.sol#L58)

	```solidity
	        } else if (nonce < 0x80) {
	```

- Found in src/utils/AddressDerivation.sol [Line: 68](src/utils/AddressDerivation.sol#L68)

	```solidity
	            uint256 nonceLength = 8;
	```

- Found in src/utils/AddressDerivation.sol [Line: 70](src/utils/AddressDerivation.sol#L70)

	```solidity
	                if ((uint256(nonce) >> 32) != 0) {
	```

- Found in src/utils/AddressDerivation.sol [Line: 71](src/utils/AddressDerivation.sol#L71)

	```solidity
	                    nonceLength += 32;
	```

- Found in src/utils/AddressDerivation.sol [Line: 76](src/utils/AddressDerivation.sol#L76)

	```solidity
	                if ((uint256(nonce) >> 8) >= (1 << nonceLength)) {
	```

- Found in src/utils/AddressDerivation.sol [Line: 77](src/utils/AddressDerivation.sol#L77)

	```solidity
	                    nonceLength += 16;
	```

- Found in src/utils/AddressDerivation.sol [Line: 79](src/utils/AddressDerivation.sol#L79)

	```solidity
	                if (uint256(nonce) >= (1 << nonceLength)) {
	```

- Found in src/utils/AddressDerivation.sol [Line: 80](src/utils/AddressDerivation.sol#L80)

	```solidity
	                    nonceLength += 8;
	```

- Found in src/utils/AddressDerivation.sol [Line: 83](src/utils/AddressDerivation.sol#L83)

	```solidity
	                if ((uint256(nonce) << 8) >= (1 << nonceLength)) {
	```

- Found in src/utils/AddressDerivation.sol [Line: 84](src/utils/AddressDerivation.sol#L84)

	```solidity
	                    nonceLength += 8;
	```

- Found in src/utils/AddressDerivation.sol [Line: 87](src/utils/AddressDerivation.sol#L87)

	```solidity
	                nonceLength >>= 3;
	```

- Found in src/utils/Create3.sol [Line: 209](src/utils/Create3.sol#L209)

	```solidity
	            AddressDerivation.deriveContract(AddressDerivation.deriveDeterministicContract(deployer, salt, initHash), 1);
	```

- Found in src/utils/IPFS.sol [Line: 14](src/utils/IPFS.sol#L14)

	```solidity
	            if (contentLength >= 0x40001) {
	```

- Found in src/utils/IPFS.sol [Line: 18](src/utils/IPFS.sol#L18)

	```solidity
	            bytes memory len2 = _protobufVarint(contentLength == 0 ? 4 : contentLength + 4 + 2 * len.length);
	```

- Found in src/utils/IPFS.sol [Line: 90](src/utils/IPFS.sol#L90)

	```solidity
	        if (x >= 0x200000) {
	```

- Found in src/utils/UnsafeMath.sol [Line: 7](src/utils/UnsafeMath.sol#L7)

	```solidity
	            return x + 1;
	```

- Found in src/utils/UnsafeMath.sol [Line: 13](src/utils/UnsafeMath.sol#L13)

	```solidity
	            return x + 1;
	```



## NC-3: Event is missing `indexed` fields

Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.

- Found in src/ChainCompatibility.sol [Line: 5](src/ChainCompatibility.sol#L5)

	```solidity
	    event GasUsed(uint256 stage, bool success, uint256 gasUsed);
	```

- Found in src/deployer/IDeployer.sol [Line: 13](src/deployer/IDeployer.sol#L13)

	```solidity
	    event PermanentURI(string, uint256 indexed); // not technically part of the standard
	```

- Found in src/deployer/IDeployer.sol [Line: 53](src/deployer/IDeployer.sol#L53)

	```solidity
	    event Authorized(Feature indexed, address indexed, uint40);
	```



## NC-4: `require()` / `revert()` statements should have descriptive reason strings or custom errors



- Found in src/SettlerMetaTxn.sol [Line: 132](src/SettlerMetaTxn.sol#L132)

	```solidity
	        require(actions.length != 0);
	```

- Found in src/allowanceholder/AllowanceHolder.sol [Line: 10](src/allowanceholder/AllowanceHolder.sol#L10)

	```solidity
	        require(address(this) == 0x0000000000001fF3684f28c67538d4D072C22734 || block.chainid == 31337);
	```

- Found in src/core/CurveTricrypto.sol [Line: 111](src/core/CurveTricrypto.sol#L111)

	```solidity
	        require(data.length == 0xa0);
	```

- Found in src/core/MaverickV2.sol [Line: 222](src/core/MaverickV2.sol#L222)

	```solidity
	        require(data.length >= 0xa0);
	```

- Found in src/core/Permit2Payment.sol [Line: 219](src/core/Permit2Payment.sol#L219)

	```solidity
	        require(bytes4(data) == selector);
	```

- Found in src/core/Permit2Payment.sol [Line: 220](src/core/Permit2Payment.sol#L220)

	```solidity
	        require(msg.sender == operator);
	```

- Found in src/core/Permit2Payment.sol [Line: 352](src/core/Permit2Payment.sol#L352)

	```solidity
	        revert();
	```

- Found in src/core/Permit2Payment.sol [Line: 398](src/core/Permit2Payment.sol#L398)

	```solidity
	        revert();
	```

- Found in src/core/UniswapV3Fork.sol [Line: 315](src/core/UniswapV3Fork.sol#L315)

	```solidity
	        require(data.length >= 0x80);
	```

- Found in src/deployer/Deployer.sol [Line: 152](src/deployer/Deployer.sol#L152)

	```solidity
	        require(address(this) == 0x00000000000004533Fe15556B1E086BB1A72cEae || block.chainid == 31337);
	```

- Found in src/deployer/Deployer.sol [Line: 196](src/deployer/Deployer.sol#L196)

	```solidity
	        require((auth == address(0)) == (block.timestamp > deadline));
	```



