# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [High Issues](#high-issues)
  - [H-1: Unsafe Casting](#h-1-unsafe-casting)
- [Low Issues](#low-issues)
  - [L-1: Centralization Risk for trusted owners](#l-1-centralization-risk-for-trusted-owners)
  - [L-2: Unsafe ERC20 Operations should not be used](#l-2-unsafe-erc20-operations-should-not-be-used)
  - [L-3: Solidity pragma should be specific, not wide](#l-3-solidity-pragma-should-be-specific-not-wide)
  - [L-4: Missing checks for `address(0)` when assigning values to address state variables](#l-4-missing-checks-for-address0-when-assigning-values-to-address-state-variables)
  - [L-5: `public` functions not used internally could be marked `external`](#l-5-public-functions-not-used-internally-could-be-marked-external)
  - [L-6: Define and use `constant` variables instead of using literals](#l-6-define-and-use-constant-variables-instead-of-using-literals)
  - [L-7: Event is missing `indexed` fields](#l-7-event-is-missing-indexed-fields)
  - [L-8: Empty `require()` / `revert()` statements](#l-8-empty-require--revert-statements)
  - [L-9: PUSH0 is not supported by all chains](#l-9-push0-is-not-supported-by-all-chains)
  - [L-10: Empty Block](#l-10-empty-block)
  - [L-11: Loop contains `require`/`revert` statements](#l-11-loop-contains-requirerevert-statements)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 38 |
| Total nSLOC | 3325 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| ccip/AggregateRateLimiter.sol | 51 |
| ccip/CommitStore.sol | 169 |
| ccip/RMN.sol | 658 |
| ccip/applications/EtherSenderReceiver.sol | 85 |
| ccip/applications/PingPongDemo.sol | 74 |
| ccip/applications/SelfFundedPingPong.sol | 45 |
| ccip/applications/TokenProxy.sol | 53 |
| ccip/interfaces/IAny2EVMMessageReceiver.sol | 5 |
| ccip/interfaces/IAny2EVMOffRamp.sol | 4 |
| ccip/interfaces/ICommitStore.sol | 9 |
| ccip/interfaces/IEVM2AnyOnRamp.sol | 6 |
| ccip/interfaces/IEVM2AnyOnRampClient.sol | 15 |
| ccip/interfaces/IGetCCIPAdmin.sol | 4 |
| ccip/interfaces/IOwner.sol | 4 |
| ccip/interfaces/IPool.sol | 13 |
| ccip/interfaces/IPoolPriorTo1_5.sol | 19 |
| ccip/interfaces/IPriceRegistry.sol | 21 |
| ccip/interfaces/IRMN.sol | 10 |
| ccip/interfaces/ITokenAdminRegistry.sol | 5 |
| ccip/interfaces/IWrappedNative.sol | 6 |
| ccip/interfaces/automation/ILinkAvailable.sol | 4 |
| ccip/libraries/Client.sol | 36 |
| ccip/libraries/Internal.sol | 121 |
| ccip/libraries/Pool.sol | 30 |
| ccip/offRamp/EVM2EVMOffRamp.sol | 409 |
| ccip/onRamp/EVM2EVMOnRamp.sol | 558 |
| ccip/pools/BurnFromMintTokenPool.sol | 21 |
| ccip/pools/BurnMintTokenPool.sol | 17 |
| ccip/pools/BurnMintTokenPoolAbstract.sol | 29 |
| ccip/pools/BurnMintTokenPoolAndProxy.sol | 44 |
| ccip/pools/BurnWithFromMintTokenPool.sol | 21 |
| ccip/pools/LegacyPoolWrapper.sol | 42 |
| ccip/pools/LockReleaseTokenPool.sol | 86 |
| ccip/pools/LockReleaseTokenPoolAndProxy.sol | 93 |
| ccip/pools/TokenPool.sol | 263 |
| ccip/pools/USDC/USDCTokenPool.sol | 147 |
| ccip/tokenAdminRegistry/RegistryModuleOwnerCustom.sol | 27 |
| ccip/tokenAdminRegistry/TokenAdminRegistry.sol | 121 |
| **Total** | **3325** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 1 |
| Low | 11 |


# High Issues

## H-1: Unsafe Casting

Downcasting int/uints in Solidity can be unsafe due to the potential for data loss and unintended behavior.When downcasting a larger integer type to a smaller one (e.g., uint256 to uint128), the value may exceed the range of the target type,leading to truncation and loss of significant digits. Use OpenZeppelin's SafeCast library to safely downcast integers.

<details><summary>2 Found Instances</summary>


- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 296](ccip/onRamp/EVM2EVMOnRamp.sol#L296)

	```solidity
	      s_nopFeesJuels += uint96(feeTokenAmount);
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 772](ccip/onRamp/EVM2EVMOnRamp.sol#L772)

	```solidity
	      nopsAndWeights[i] = NopAndWeight({nop: nopAddress, weight: uint16(nopWeight)});
	```

</details>



# Low Issues

## L-1: Centralization Risk for trusted owners

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

<details><summary>31 Found Instances</summary>


- Found in ccip/CommitStore.sol [Line: 116](ccip/CommitStore.sol#L116)

	```solidity
	  function setMinSeqNr(uint64 minSeqNr) external onlyOwner {
	```

- Found in ccip/CommitStore.sol [Line: 132](ccip/CommitStore.sol#L132)

	```solidity
	  function setLatestPriceEpochAndRound(uint40 latestPriceEpochAndRound) external onlyOwner {
	```

- Found in ccip/CommitStore.sol [Line: 160](ccip/CommitStore.sol#L160)

	```solidity
	  function resetUnblessedRoots(bytes32[] calldata rootToReset) external onlyOwner {
	```

- Found in ccip/CommitStore.sol [Line: 303](ccip/CommitStore.sol#L303)

	```solidity
	  function pause() external onlyOwner {
	```

- Found in ccip/CommitStore.sol [Line: 310](ccip/CommitStore.sol#L310)

	```solidity
	  function unpause() external onlyOwner {
	```

- Found in ccip/RMN.sol [Line: 405](ccip/RMN.sol#L405)

	```solidity
	  function ownerResetBlessVotes(IRMN.TaggedRoot[] calldata taggedRoots) external onlyOwner {
	```

- Found in ccip/RMN.sol [Line: 618](ccip/RMN.sol#L618)

	```solidity
	  function ownerCurse(bytes16 curseId, bytes16[] memory subjects) external onlyOwner {
	```

- Found in ccip/RMN.sol [Line: 638](ccip/RMN.sol#L638)

	```solidity
	  function ownerUnvoteToCurse(OwnerUnvoteToCurseRequest[] memory ownerUnvoteToCurseRequests) external onlyOwner {
	```

- Found in ccip/RMN.sol [Line: 670](ccip/RMN.sol#L670)

	```solidity
	  function setConfig(Config memory config) external onlyOwner {
	```

- Found in ccip/RMN.sol [Line: 684](ccip/RMN.sol#L684)

	```solidity
	  ) external onlyOwner {
	```

- Found in ccip/applications/PingPongDemo.sol [Line: 37](ccip/applications/PingPongDemo.sol#L37)

	```solidity
	  function setCounterpart(uint64 counterpartChainSelector, address counterpartAddress) external onlyOwner {
	```

- Found in ccip/applications/PingPongDemo.sol [Line: 42](ccip/applications/PingPongDemo.sol#L42)

	```solidity
	  function startPingPong() external onlyOwner {
	```

- Found in ccip/applications/PingPongDemo.sol [Line: 79](ccip/applications/PingPongDemo.sol#L79)

	```solidity
	  function setCounterpartChainSelector(uint64 chainSelector) external onlyOwner {
	```

- Found in ccip/applications/PingPongDemo.sol [Line: 91](ccip/applications/PingPongDemo.sol#L91)

	```solidity
	  function setCounterpartAddress(address addr) external onlyOwner {
	```

- Found in ccip/applications/PingPongDemo.sol [Line: 99](ccip/applications/PingPongDemo.sol#L99)

	```solidity
	  function setPaused(bool pause) external onlyOwner {
	```

- Found in ccip/applications/SelfFundedPingPong.sol [Line: 63](ccip/applications/SelfFundedPingPong.sol#L63)

	```solidity
	  function setCountIncrBeforeFunding(uint8 countIncrBeforeFunding) external onlyOwner {
	```

- Found in ccip/offRamp/EVM2EVMOffRamp.sol [Line: 554](ccip/offRamp/EVM2EVMOffRamp.sol#L554)

	```solidity
	  function updateRateLimitTokens(RateLimitToken[] memory removes, RateLimitToken[] memory adds) external onlyOwner {
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 450](ccip/onRamp/EVM2EVMOnRamp.sol#L450)

	```solidity
	  function setDynamicConfig(DynamicConfig memory dynamicConfig) external onlyOwner {
	```

- Found in ccip/pools/LegacyPoolWrapper.sol [Line: 51](ccip/pools/LegacyPoolWrapper.sol#L51)

	```solidity
	  function setPreviousPool(IPoolPriorTo1_5 prevPool) external onlyOwner {
	```

- Found in ccip/pools/LockReleaseTokenPool.sol [Line: 97](ccip/pools/LockReleaseTokenPool.sol#L97)

	```solidity
	  function setRebalancer(address rebalancer) external onlyOwner {
	```

- Found in ccip/pools/LockReleaseTokenPool.sol [Line: 104](ccip/pools/LockReleaseTokenPool.sol#L104)

	```solidity
	  function setRateLimitAdmin(address rateLimitAdmin) external onlyOwner {
	```

- Found in ccip/pools/LockReleaseTokenPoolAndProxy.sol [Line: 104](ccip/pools/LockReleaseTokenPoolAndProxy.sol#L104)

	```solidity
	  function setRebalancer(address rebalancer) external onlyOwner {
	```

- Found in ccip/pools/LockReleaseTokenPoolAndProxy.sol [Line: 111](ccip/pools/LockReleaseTokenPoolAndProxy.sol#L111)

	```solidity
	  function setRateLimitAdmin(address rateLimitAdmin) external onlyOwner {
	```

- Found in ccip/pools/TokenPool.sol [Line: 129](ccip/pools/TokenPool.sol#L129)

	```solidity
	  function setRouter(address newRouter) public onlyOwner {
	```

- Found in ccip/pools/TokenPool.sol [Line: 211](ccip/pools/TokenPool.sol#L211)

	```solidity
	  function setRemotePool(uint64 remoteChainSelector, bytes calldata remotePoolAddress) external onlyOwner {
	```

- Found in ccip/pools/TokenPool.sol [Line: 242](ccip/pools/TokenPool.sol#L242)

	```solidity
	  function applyChainUpdates(ChainUpdate[] calldata chains) external virtual onlyOwner {
	```

- Found in ccip/pools/TokenPool.sol [Line: 338](ccip/pools/TokenPool.sol#L338)

	```solidity
	  ) external virtual onlyOwner {
	```

- Found in ccip/pools/TokenPool.sol [Line: 396](ccip/pools/TokenPool.sol#L396)

	```solidity
	  function applyAllowListUpdates(address[] calldata removes, address[] calldata adds) external onlyOwner {
	```

- Found in ccip/pools/USDC/USDCTokenPool.sol [Line: 228](ccip/pools/USDC/USDCTokenPool.sol#L228)

	```solidity
	  function setDomains(DomainUpdate[] calldata domains) external onlyOwner {
	```

- Found in ccip/tokenAdminRegistry/TokenAdminRegistry.sol [Line: 198](ccip/tokenAdminRegistry/TokenAdminRegistry.sol#L198)

	```solidity
	  function addRegistryModule(address module) external onlyOwner {
	```

- Found in ccip/tokenAdminRegistry/TokenAdminRegistry.sol [Line: 206](ccip/tokenAdminRegistry/TokenAdminRegistry.sol#L206)

	```solidity
	  function removeRegistryModule(address module) external onlyOwner {
	```

</details>



## L-2: Unsafe ERC20 Operations should not be used

ERC20 functions may not behave as expected. For example: return values are not always meaningful. It is recommended to use OpenZeppelin's SafeERC20 library.

<details><summary>8 Found Instances</summary>


- Found in ccip/applications/EtherSenderReceiver.sol [Line: 48](ccip/applications/EtherSenderReceiver.sol#L48)

	```solidity
	    i_weth.approve(router, type(uint256).max);
	```

- Found in ccip/applications/EtherSenderReceiver.sol [Line: 104](ccip/applications/EtherSenderReceiver.sol#L104)

	```solidity
	        IERC20(validatedMessage.feeToken).approve(getRouter(), fee);
	```

- Found in ccip/applications/EtherSenderReceiver.sol [Line: 177](ccip/applications/EtherSenderReceiver.sol#L177)

	```solidity
	      i_weth.transfer(receiver, tokenAmount);
	```

- Found in ccip/applications/PingPongDemo.sol [Line: 30](ccip/applications/PingPongDemo.sol#L30)

	```solidity
	    s_feeToken.approve(address(router), type(uint256).max);
	```

- Found in ccip/applications/TokenProxy.sol [Line: 29](ccip/applications/TokenProxy.sol#L29)

	```solidity
	    IERC20(token).approve(router, type(uint256).max);
	```

- Found in ccip/applications/TokenProxy.sol [Line: 56](ccip/applications/TokenProxy.sol#L56)

	```solidity
	      IERC20(message.feeToken).approve(address(i_ccipRouter), feeAmount);
	```

- Found in ccip/applications/TokenProxy.sol [Line: 60](ccip/applications/TokenProxy.sol#L60)

	```solidity
	    IERC20(message.tokenAmounts[0].token).transferFrom(msg.sender, address(this), message.tokenAmounts[0].amount);
	```

- Found in ccip/offRamp/EVM2EVMOffRamp.sol [Line: 641](ccip/offRamp/EVM2EVMOffRamp.sol#L641)

	```solidity
	      abi.encodeWithSelector(IERC20.transfer.selector, receiver, localAmount),
	```

</details>



## L-3: Solidity pragma should be specific, not wide

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

<details><summary>20 Found Instances</summary>


- Found in ccip/applications/PingPongDemo.sol [Line: 2](ccip/applications/PingPongDemo.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/applications/SelfFundedPingPong.sol [Line: 2](ccip/applications/SelfFundedPingPong.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IAny2EVMMessageReceiver.sol [Line: 2](ccip/interfaces/IAny2EVMMessageReceiver.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IAny2EVMOffRamp.sol [Line: 2](ccip/interfaces/IAny2EVMOffRamp.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/ICommitStore.sol [Line: 2](ccip/interfaces/ICommitStore.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IEVM2AnyOnRamp.sol [Line: 2](ccip/interfaces/IEVM2AnyOnRamp.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IEVM2AnyOnRampClient.sol [Line: 2](ccip/interfaces/IEVM2AnyOnRampClient.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IGetCCIPAdmin.sol [Line: 2](ccip/interfaces/IGetCCIPAdmin.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IOwner.sol [Line: 2](ccip/interfaces/IOwner.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IPool.sol [Line: 2](ccip/interfaces/IPool.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IPoolPriorTo1_5.sol [Line: 2](ccip/interfaces/IPoolPriorTo1_5.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IPriceRegistry.sol [Line: 2](ccip/interfaces/IPriceRegistry.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IRMN.sol [Line: 2](ccip/interfaces/IRMN.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/ITokenAdminRegistry.sol [Line: 2](ccip/interfaces/ITokenAdminRegistry.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IWrappedNative.sol [Line: 2](ccip/interfaces/IWrappedNative.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/automation/ILinkAvailable.sol [Line: 2](ccip/interfaces/automation/ILinkAvailable.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/libraries/Client.sol [Line: 2](ccip/libraries/Client.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/libraries/Internal.sol [Line: 2](ccip/libraries/Internal.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/libraries/Pool.sol [Line: 2](ccip/libraries/Pool.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/pools/LegacyPoolWrapper.sol [Line: 2](ccip/pools/LegacyPoolWrapper.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

</details>



## L-4: Missing checks for `address(0)` when assigning values to address state variables

Check for `address(0)` when assigning values to address state variables.

<details><summary>9 Found Instances</summary>


- Found in ccip/AggregateRateLimiter.sol [Line: 83](ccip/AggregateRateLimiter.sol#L83)

	```solidity
	    s_admin = newAdmin;
	```

- Found in ccip/applications/PingPongDemo.sol [Line: 29](ccip/applications/PingPongDemo.sol#L29)

	```solidity
	    s_feeToken = feeToken;
	```

- Found in ccip/applications/PingPongDemo.sol [Line: 39](ccip/applications/PingPongDemo.sol#L39)

	```solidity
	    s_counterpartAddress = counterpartAddress;
	```

- Found in ccip/applications/PingPongDemo.sol [Line: 92](ccip/applications/PingPongDemo.sol#L92)

	```solidity
	    s_counterpartAddress = addr;
	```

- Found in ccip/pools/LegacyPoolWrapper.sol [Line: 53](ccip/pools/LegacyPoolWrapper.sol#L53)

	```solidity
	    s_previousPool = prevPool;
	```

- Found in ccip/pools/LockReleaseTokenPool.sol [Line: 98](ccip/pools/LockReleaseTokenPool.sol#L98)

	```solidity
	    s_rebalancer = rebalancer;
	```

- Found in ccip/pools/LockReleaseTokenPool.sol [Line: 105](ccip/pools/LockReleaseTokenPool.sol#L105)

	```solidity
	    s_rateLimitAdmin = rateLimitAdmin;
	```

- Found in ccip/pools/LockReleaseTokenPoolAndProxy.sol [Line: 105](ccip/pools/LockReleaseTokenPoolAndProxy.sol#L105)

	```solidity
	    s_rebalancer = rebalancer;
	```

- Found in ccip/pools/LockReleaseTokenPoolAndProxy.sol [Line: 112](ccip/pools/LockReleaseTokenPoolAndProxy.sol#L112)

	```solidity
	    s_rateLimitAdmin = rateLimitAdmin;
	```

</details>



## L-5: `public` functions not used internally could be marked `external`

Instead of marking a function as `public`, consider marking it as `external` if it is not used internally.

<details><summary>2 Found Instances</summary>


- Found in ccip/pools/LockReleaseTokenPool.sol [Line: 85](ccip/pools/LockReleaseTokenPool.sol#L85)

	```solidity
	  function supportsInterface(bytes4 interfaceId) public pure virtual override returns (bool) {
	```

- Found in ccip/pools/LockReleaseTokenPoolAndProxy.sol [Line: 92](ccip/pools/LockReleaseTokenPoolAndProxy.sol#L92)

	```solidity
	  function supportsInterface(bytes4 interfaceId) public pure virtual override returns (bool) {
	```

</details>



## L-6: Define and use `constant` variables instead of using literals

If the same constant literal value is used multiple times, create a constant state variable and reference it throughout the contract.

<details><summary>11 Found Instances</summary>


- Found in ccip/offRamp/EVM2EVMOffRamp.sol [Line: 183](ccip/offRamp/EVM2EVMOffRamp.sol#L183)

	```solidity
	      (s_executionStates[sequenceNumber / 128] >> ((sequenceNumber % 128) * MESSAGE_EXECUTION_STATE_BIT_WIDTH))
	```

- Found in ccip/offRamp/EVM2EVMOffRamp.sol [Line: 193](ccip/offRamp/EVM2EVMOffRamp.sol#L193)

	```solidity
	    uint256 offset = (sequenceNumber % 128) * MESSAGE_EXECUTION_STATE_BIT_WIDTH;
	```

- Found in ccip/offRamp/EVM2EVMOffRamp.sol [Line: 194](ccip/offRamp/EVM2EVMOffRamp.sol#L194)

	```solidity
	    uint256 bitmap = s_executionStates[sequenceNumber / 128];
	```

- Found in ccip/offRamp/EVM2EVMOffRamp.sol [Line: 201](ccip/offRamp/EVM2EVMOffRamp.sol#L201)

	```solidity
	    s_executionStates[sequenceNumber / 128] = bitmap;
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 393](ccip/onRamp/EVM2EVMOnRamp.sol#L393)

	```solidity
	      return abi.decode(extraArgs[4:], (Client.EVMExtraArgsV2));
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 397](ccip/onRamp/EVM2EVMOnRamp.sol#L397)

	```solidity
	      return Client.EVMExtraArgsV2({gasLimit: abi.decode(extraArgs[4:], (uint256)), allowOutOfOrderExecution: false});
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 532](ccip/onRamp/EVM2EVMOnRamp.sol#L532)

	```solidity
	      premiumFee = uint256(feeTokenConfig.networkFeeUSDCents) * 1e16;
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 627](ccip/onRamp/EVM2EVMOnRamp.sol#L627)

	```solidity
	        tokenTransferFeeUSDWei += uint256(s_dynamicConfig.defaultTokenFeeUSDCents) * 1e16;
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 654](ccip/onRamp/EVM2EVMOnRamp.sol#L654)

	```solidity
	      uint256 minFeeUSDWei = uint256(transferFeeConfig.minFeeUSDCents) * 1e16;
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 660](ccip/onRamp/EVM2EVMOnRamp.sol#L660)

	```solidity
	      uint256 maxFeeUSDWei = uint256(transferFeeConfig.maxFeeUSDCents) * 1e16;
	```

</details>



## L-7: Event is missing `indexed` fields

Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.

<details><summary>52 Found Instances</summary>


- Found in ccip/AggregateRateLimiter.sol [Line: 20](ccip/AggregateRateLimiter.sol#L20)

	```solidity
	  event AdminSet(address newAdmin);
	```

- Found in ccip/CommitStore.sol [Line: 22](ccip/CommitStore.sol#L22)

	```solidity
	  event Paused(address account);
	```

- Found in ccip/CommitStore.sol [Line: 23](ccip/CommitStore.sol#L23)

	```solidity
	  event Unpaused(address account);
	```

- Found in ccip/CommitStore.sol [Line: 25](ccip/CommitStore.sol#L25)

	```solidity
	  event ReportAccepted(CommitReport report);
	```

- Found in ccip/CommitStore.sol [Line: 26](ccip/CommitStore.sol#L26)

	```solidity
	  event ConfigSet(StaticConfig staticConfig, DynamicConfig dynamicConfig);
	```

- Found in ccip/CommitStore.sol [Line: 27](ccip/CommitStore.sol#L27)

	```solidity
	  event RootRemoved(bytes32 root);
	```

- Found in ccip/CommitStore.sol [Line: 28](ccip/CommitStore.sol#L28)

	```solidity
	  event SequenceNumberSet(uint64 oldSeqNum, uint64 newSeqNum);
	```

- Found in ccip/CommitStore.sol [Line: 29](ccip/CommitStore.sol#L29)

	```solidity
	  event LatestPriceEpochAndRoundSet(uint40 oldEpochAndRound, uint40 newEpochAndRound);
	```

- Found in ccip/RMN.sol [Line: 244](ccip/RMN.sol#L244)

	```solidity
	  event ConfigSet(uint32 indexed configVersion, Config config);
	```

- Found in ccip/RMN.sol [Line: 248](ccip/RMN.sol#L248)

	```solidity
	  event TaggedRootBlessed(uint32 indexed configVersion, IRMN.TaggedRoot taggedRoot, uint16 accumulatedWeight);
	```

- Found in ccip/RMN.sol [Line: 249](ccip/RMN.sol#L249)

	```solidity
	  event TaggedRootBlessVotesReset(uint32 indexed configVersion, IRMN.TaggedRoot taggedRoot, bool wasBlessed);
	```

- Found in ccip/RMN.sol [Line: 250](ccip/RMN.sol#L250)

	```solidity
	  event VotedToBless(uint32 indexed configVersion, address indexed voter, IRMN.TaggedRoot taggedRoot, uint8 weight);
	```

- Found in ccip/RMN.sol [Line: 252](ccip/RMN.sol#L252)

	```solidity
	  event VotedToCurse(
	```

- Found in ccip/RMN.sol [Line: 262](ccip/RMN.sol#L262)

	```solidity
	  event UnvotedToCurse(
	```

- Found in ccip/RMN.sol [Line: 270](ccip/RMN.sol#L270)

	```solidity
	  event SkippedUnvoteToCurse(address indexed voter, bytes16 subject, bytes28 onchainCursesHash, bytes28 cursesHash);
	```

- Found in ccip/RMN.sol [Line: 271](ccip/RMN.sol#L271)

	```solidity
	  event Cursed(uint32 indexed configVersion, bytes16 subject, uint64 blockTimestamp);
	```

- Found in ccip/RMN.sol [Line: 272](ccip/RMN.sol#L272)

	```solidity
	  event CurseLifted(bytes16 subject);
	```

- Found in ccip/RMN.sol [Line: 276](ccip/RMN.sol#L276)

	```solidity
	  event AlreadyVotedToBless(uint32 indexed configVersion, address indexed voter, IRMN.TaggedRoot taggedRoot);
	```

- Found in ccip/RMN.sol [Line: 277](ccip/RMN.sol#L277)

	```solidity
	  event AlreadyBlessed(uint32 indexed configVersion, address indexed voter, IRMN.TaggedRoot taggedRoot);
	```

- Found in ccip/RMN.sol [Line: 280](ccip/RMN.sol#L280)

	```solidity
	  event PermaBlessedCommitStoreAdded(address commitStore);
	```

- Found in ccip/RMN.sol [Line: 281](ccip/RMN.sol#L281)

	```solidity
	  event PermaBlessedCommitStoreRemoved(address commitStore);
	```

- Found in ccip/applications/PingPongDemo.sol [Line: 15](ccip/applications/PingPongDemo.sol#L15)

	```solidity
	  event Ping(uint256 pingPongCount);
	```

- Found in ccip/applications/PingPongDemo.sol [Line: 16](ccip/applications/PingPongDemo.sol#L16)

	```solidity
	  event Pong(uint256 pingPongCount);
	```

- Found in ccip/applications/SelfFundedPingPong.sol [Line: 15](ccip/applications/SelfFundedPingPong.sol#L15)

	```solidity
	  event CountIncrBeforeFundingSet(uint8 countIncrBeforeFunding);
	```

- Found in ccip/offRamp/EVM2EVMOffRamp.sol [Line: 62](ccip/offRamp/EVM2EVMOffRamp.sol#L62)

	```solidity
	  event ConfigSet(StaticConfig staticConfig, DynamicConfig dynamicConfig);
	```

- Found in ccip/offRamp/EVM2EVMOffRamp.sol [Line: 66](ccip/offRamp/EVM2EVMOffRamp.sol#L66)

	```solidity
	  event ExecutionStateChanged(
	```

- Found in ccip/offRamp/EVM2EVMOffRamp.sol [Line: 69](ccip/offRamp/EVM2EVMOffRamp.sol#L69)

	```solidity
	  event TokenAggregateRateLimitAdded(address sourceToken, address destToken);
	```

- Found in ccip/offRamp/EVM2EVMOffRamp.sol [Line: 70](ccip/offRamp/EVM2EVMOffRamp.sol#L70)

	```solidity
	  event TokenAggregateRateLimitRemoved(address sourceToken, address destToken);
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 60](ccip/onRamp/EVM2EVMOnRamp.sol#L60)

	```solidity
	  event ConfigSet(StaticConfig staticConfig, DynamicConfig dynamicConfig);
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 61](ccip/onRamp/EVM2EVMOnRamp.sol#L61)

	```solidity
	  event NopPaid(address indexed nop, uint256 amount);
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 62](ccip/onRamp/EVM2EVMOnRamp.sol#L62)

	```solidity
	  event FeeConfigSet(FeeTokenConfigArgs[] feeConfig);
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 63](ccip/onRamp/EVM2EVMOnRamp.sol#L63)

	```solidity
	  event TokenTransferFeeConfigSet(TokenTransferFeeConfigArgs[] transferFeeConfig);
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 64](ccip/onRamp/EVM2EVMOnRamp.sol#L64)

	```solidity
	  event TokenTransferFeeConfigDeleted(address[] tokens);
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 66](ccip/onRamp/EVM2EVMOnRamp.sol#L66)

	```solidity
	  event CCIPSendRequested(Internal.EVM2EVMMessage message);
	```

- Found in ccip/onRamp/EVM2EVMOnRamp.sol [Line: 67](ccip/onRamp/EVM2EVMOnRamp.sol#L67)

	```solidity
	  event NopsSet(uint256 nopWeightsTotal, NopAndWeight[] nopsAndWeights);
	```

- Found in ccip/pools/LegacyPoolWrapper.sol [Line: 15](ccip/pools/LegacyPoolWrapper.sol#L15)

	```solidity
	  event LegacyPoolChanged(IPoolPriorTo1_5 oldPool, IPoolPriorTo1_5 newPool);
	```

- Found in ccip/pools/TokenPool.sol [Line: 35](ccip/pools/TokenPool.sol#L35)

	```solidity
	  event Locked(address indexed sender, uint256 amount);
	```

- Found in ccip/pools/TokenPool.sol [Line: 36](ccip/pools/TokenPool.sol#L36)

	```solidity
	  event Burned(address indexed sender, uint256 amount);
	```

- Found in ccip/pools/TokenPool.sol [Line: 37](ccip/pools/TokenPool.sol#L37)

	```solidity
	  event Released(address indexed sender, address indexed recipient, uint256 amount);
	```

- Found in ccip/pools/TokenPool.sol [Line: 38](ccip/pools/TokenPool.sol#L38)

	```solidity
	  event Minted(address indexed sender, address indexed recipient, uint256 amount);
	```

- Found in ccip/pools/TokenPool.sol [Line: 39](ccip/pools/TokenPool.sol#L39)

	```solidity
	  event ChainAdded(
	```

- Found in ccip/pools/TokenPool.sol [Line: 45](ccip/pools/TokenPool.sol#L45)

	```solidity
	  event ChainConfigured(
	```

- Found in ccip/pools/TokenPool.sol [Line: 50](ccip/pools/TokenPool.sol#L50)

	```solidity
	  event ChainRemoved(uint64 remoteChainSelector);
	```

- Found in ccip/pools/TokenPool.sol [Line: 51](ccip/pools/TokenPool.sol#L51)

	```solidity
	  event RemotePoolSet(uint64 indexed remoteChainSelector, bytes previousPoolAddress, bytes remotePoolAddress);
	```

- Found in ccip/pools/TokenPool.sol [Line: 52](ccip/pools/TokenPool.sol#L52)

	```solidity
	  event AllowListAdd(address sender);
	```

- Found in ccip/pools/TokenPool.sol [Line: 53](ccip/pools/TokenPool.sol#L53)

	```solidity
	  event AllowListRemove(address sender);
	```

- Found in ccip/pools/TokenPool.sol [Line: 54](ccip/pools/TokenPool.sol#L54)

	```solidity
	  event RouterUpdated(address oldRouter, address newRouter);
	```

- Found in ccip/pools/USDC/USDCTokenPool.sol [Line: 19](ccip/pools/USDC/USDCTokenPool.sol#L19)

	```solidity
	  event DomainsSet(DomainUpdate[]);
	```

- Found in ccip/pools/USDC/USDCTokenPool.sol [Line: 20](ccip/pools/USDC/USDCTokenPool.sol#L20)

	```solidity
	  event ConfigSet(address tokenMessenger);
	```

- Found in ccip/tokenAdminRegistry/TokenAdminRegistry.sol [Line: 29](ccip/tokenAdminRegistry/TokenAdminRegistry.sol#L29)

	```solidity
	  event DisableReRegistrationSet(address indexed token, bool disabled);
	```

- Found in ccip/tokenAdminRegistry/TokenAdminRegistry.sol [Line: 30](ccip/tokenAdminRegistry/TokenAdminRegistry.sol#L30)

	```solidity
	  event RemovedAdministrator(address token);
	```

- Found in ccip/tokenAdminRegistry/TokenAdminRegistry.sol [Line: 31](ccip/tokenAdminRegistry/TokenAdminRegistry.sol#L31)

	```solidity
	  event RegistryModuleAdded(address module);
	```

</details>



## L-8: Empty `require()` / `revert()` statements

Use descriptive reason strings or custom errors for revert paths.

<details><summary>3 Found Instances</summary>


- Found in ccip/RMN.sol [Line: 492](ccip/RMN.sol#L492)

	```solidity
	        revert(); // assumption violation
	```

- Found in ccip/RMN.sol [Line: 817](ccip/RMN.sol#L817)

	```solidity
	            revert(); // assumption violation
	```

- Found in ccip/offRamp/EVM2EVMOffRamp.sol [Line: 700](ccip/offRamp/EVM2EVMOffRamp.sol#L700)

	```solidity
	    revert();
	```

</details>



## L-9: PUSH0 is not supported by all chains

Solc compiler version 0.8.20 switches the default target EVM version to Shanghai, which means that the generated bytecode will include PUSH0 opcodes. Be sure to select the appropriate EVM version in case you intend to deploy on a chain other than mainnet like L2 chains that may not support PUSH0, otherwise deployment of your contracts will fail.

<details><summary>20 Found Instances</summary>


- Found in ccip/applications/PingPongDemo.sol [Line: 2](ccip/applications/PingPongDemo.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/applications/SelfFundedPingPong.sol [Line: 2](ccip/applications/SelfFundedPingPong.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IAny2EVMMessageReceiver.sol [Line: 2](ccip/interfaces/IAny2EVMMessageReceiver.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IAny2EVMOffRamp.sol [Line: 2](ccip/interfaces/IAny2EVMOffRamp.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/ICommitStore.sol [Line: 2](ccip/interfaces/ICommitStore.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IEVM2AnyOnRamp.sol [Line: 2](ccip/interfaces/IEVM2AnyOnRamp.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IEVM2AnyOnRampClient.sol [Line: 2](ccip/interfaces/IEVM2AnyOnRampClient.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IGetCCIPAdmin.sol [Line: 2](ccip/interfaces/IGetCCIPAdmin.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IOwner.sol [Line: 2](ccip/interfaces/IOwner.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IPool.sol [Line: 2](ccip/interfaces/IPool.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IPoolPriorTo1_5.sol [Line: 2](ccip/interfaces/IPoolPriorTo1_5.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IPriceRegistry.sol [Line: 2](ccip/interfaces/IPriceRegistry.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IRMN.sol [Line: 2](ccip/interfaces/IRMN.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/ITokenAdminRegistry.sol [Line: 2](ccip/interfaces/ITokenAdminRegistry.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/IWrappedNative.sol [Line: 2](ccip/interfaces/IWrappedNative.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/interfaces/automation/ILinkAvailable.sol [Line: 2](ccip/interfaces/automation/ILinkAvailable.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/libraries/Client.sol [Line: 2](ccip/libraries/Client.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/libraries/Internal.sol [Line: 2](ccip/libraries/Internal.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/libraries/Pool.sol [Line: 2](ccip/libraries/Pool.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in ccip/pools/LegacyPoolWrapper.sol [Line: 2](ccip/pools/LegacyPoolWrapper.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

</details>



## L-10: Empty Block

Consider removing empty blocks.

<details><summary>1 Found Instances</summary>


- Found in ccip/RMN.sol [Line: 202](ccip/RMN.sol#L202)

	```solidity
	  function _getUpToDateCurseVoteProgress(
	```

</details>



## L-11: Loop contains `require`/`revert` statements

Avoid `require` / `revert` statements in a loop because a single bad item can cause the whole transaction to fail. It's better to forgive on fail and return failed elements post processing of the loop

<details><summary>2 Found Instances</summary>


- Found in ccip/RMN.sol [Line: 787](ccip/RMN.sol#L787)

	```solidity
	    for (uint256 act = 1; act <= 2; ++act) {
	```

- Found in ccip/RMN.sol [Line: 789](ccip/RMN.sol#L789)

	```solidity
	      while (true) {
	```

</details>



