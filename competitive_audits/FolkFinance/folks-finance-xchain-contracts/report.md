# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [Medium Issues](#medium-issues)
  - [M-1: Centralization Risk for trusted owners](#m-1-centralization-risk-for-trusted-owners)
  - [M-2: Using `ERC721::_mint()` can be dangerous](#m-2-using-erc721mint-can-be-dangerous)
- [Low Issues](#low-issues)
  - [L-1: Unsafe ERC20 Operations should not be used](#l-1-unsafe-erc20-operations-should-not-be-used)
  - [L-2: Solidity pragma should be specific, not wide](#l-2-solidity-pragma-should-be-specific-not-wide)
  - [L-3: Conditional storage checks are not consistent](#l-3-conditional-storage-checks-are-not-consistent)
  - [L-4: PUSH0 is not supported by all chains](#l-4-push0-is-not-supported-by-all-chains)
- [NC Issues](#nc-issues)
  - [NC-1: Missing checks for `address(0)` when assigning values to address state variables](#nc-1-missing-checks-for-address0-when-assigning-values-to-address-state-variables)
  - [NC-2: Functions not used internally could be marked external](#nc-2-functions-not-used-internally-could-be-marked-external)
  - [NC-3: Constants should be defined and used instead of literals](#nc-3-constants-should-be-defined-and-used-instead-of-literals)
  - [NC-4: Event is missing `indexed` fields](#nc-4-event-is-missing-indexed-fields)
  - [NC-5: The `nonReentrant` `modifier` should occur before all other modifiers](#nc-5-the-nonreentrant-modifier-should-occur-before-all-other-modifiers)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 62 |
| Total nSLOC | 7474 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| contracts/bridge/BridgeMessenger.sol | 34 |
| contracts/bridge/BridgeRouter.sol | 129 |
| contracts/bridge/BridgeRouterHub.sol | 19 |
| contracts/bridge/BridgeRouterSpoke.sol | 17 |
| contracts/bridge/CCIPAdapter.sol | 78 |
| contracts/bridge/CCIPDataAdapter.sol | 54 |
| contracts/bridge/CCIPTokenAdapter.sol | 97 |
| contracts/bridge/HubAdapter.sol | 56 |
| contracts/bridge/WormholeCCTPAdapter.sol | 211 |
| contracts/bridge/WormholeDataAdapter.sol | 127 |
| contracts/bridge/interfaces/IBridgeAdapter.sol | 20 |
| contracts/bridge/interfaces/IBridgeRouter.sol | 11 |
| contracts/bridge/libraries/CCIPTokenMessages.sol | 52 |
| contracts/bridge/libraries/CCTPMessages.sol | 61 |
| contracts/bridge/libraries/Messages.sol | 122 |
| contracts/bridge/libraries/Wormhole.sol | 8 |
| contracts/hub/AccountManager.sol | 126 |
| contracts/hub/Hub.sol | 297 |
| contracts/hub/HubCircleTokenPool.sol | 44 |
| contracts/hub/HubNonBridgedTokenPool.sol | 28 |
| contracts/hub/HubPool.sol | 246 |
| contracts/hub/HubPoolState.sol | 241 |
| contracts/hub/LoanManager.sol | 257 |
| contracts/hub/LoanManagerState.sol | 317 |
| contracts/hub/OracleManager.sol | 45 |
| contracts/hub/SpokeManager.sol | 21 |
| contracts/hub/interfaces/IAccountManager.sol | 53 |
| contracts/hub/interfaces/IHubPool.sol | 72 |
| contracts/hub/interfaces/ILoanManager.sol | 48 |
| contracts/hub/interfaces/IOracleManager.sol | 6 |
| contracts/hub/interfaces/ISpokeManager.sol | 9 |
| contracts/hub/libraries/DataTypes.sol | 140 |
| contracts/hub/libraries/MathUtils.sol | 344 |
| contracts/hub/logic/HubPoolLogic.sol | 408 |
| contracts/hub/logic/LiquidationLogic.sol | 249 |
| contracts/hub/logic/LoanManagerLogic.sol | 419 |
| contracts/hub/logic/LoanPoolLogic.sol | 41 |
| contracts/hub/logic/RewardLogic.sol | 156 |
| contracts/hub/logic/UserLoanLogic.sol | 276 |
| contracts/oracle/interfaces/IExternalNode.sol | 11 |
| contracts/oracle/interfaces/INodeManager.sol | 24 |
| contracts/oracle/modules/NodeManager.sol | 139 |
| contracts/oracle/nodes/ChainlinkNode.sol | 64 |
| contracts/oracle/nodes/ConstantNode.sol | 12 |
| contracts/oracle/nodes/ExternalNode.sol | 23 |
| contracts/oracle/nodes/PriceDeviationCircuitBreakerNode.sol | 29 |
| contracts/oracle/nodes/PriceDeviationSameOracleCircuitBreakerNode.sol | 33 |
| contracts/oracle/nodes/PythNode.sol | 37 |
| contracts/oracle/nodes/ReducerNode.sol | 70 |
| contracts/oracle/nodes/StalenessCircuitBreakerNode.sol | 25 |
| contracts/oracle/storage/FeedType.sol | 6 |
| contracts/oracle/storage/NodeDefinition.sol | 36 |
| contracts/oracle/storage/NodeOutput.sol | 11 |
| contracts/spoke/AlwaysEligibleAddressOracle.sol | 7 |
| contracts/spoke/RateLimited.sol | 63 |
| contracts/spoke/SpokeCircleToken.sol | 49 |
| contracts/spoke/SpokeCommon.sol | 162 |
| contracts/spoke/SpokeErc20Token.sol | 36 |
| contracts/spoke/SpokeGasToken.sol | 31 |
| contracts/spoke/SpokeState.sol | 43 |
| contracts/spoke/SpokeToken.sol | 119 |
| contracts/spoke/interfaces/IAddressOracle.sol | 5 |
| **Total** | **7474** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| Critical | 0 |
| High | 0 |
| Medium | 2 |
| Low | 4 |
| NC | 5 |


# Medium Issues

## M-1: Centralization Risk for trusted owners

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

- Found in contracts/bridge/BridgeRouter.sol [Line: 43](contracts/bridge/BridgeRouter.sol#L43)

	```solidity
	    function addAdapter(uint16 adapterId, IBridgeAdapter adapter) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/bridge/BridgeRouter.sol [Line: 52](contracts/bridge/BridgeRouter.sol#L52)

	```solidity
	    function removeAdapter(uint16 adapterId) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/bridge/BridgeRouter.sol [Line: 71](contracts/bridge/BridgeRouter.sol#L71)

	```solidity
	    ) external payable override onlyRole(MESSAGE_SENDER_ROLE) {
	```

- Found in contracts/bridge/BridgeRouterHub.sol [Line: 14](contracts/bridge/BridgeRouterHub.sol#L14)

	```solidity
	    function withdraw(bytes32 userId, address receiver) external onlyRole(WITHDRAWER_ROLE) {
	```

- Found in contracts/bridge/CCIPAdapter.sol [Line: 58](contracts/bridge/CCIPAdapter.sol#L58)

	```solidity
	    ) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/bridge/CCIPAdapter.sol [Line: 72](contracts/bridge/CCIPAdapter.sol#L72)

	```solidity
	    function removeChain(uint16 folksChainId) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/bridge/CCIPTokenAdapter.sol [Line: 32](contracts/bridge/CCIPTokenAdapter.sol#L32)

	```solidity
	    function addSupportedToken(address token) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/bridge/CCIPTokenAdapter.sol [Line: 39](contracts/bridge/CCIPTokenAdapter.sol#L39)

	```solidity
	    function removeSupportedToken(address token) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/bridge/WormholeCCTPAdapter.sol [Line: 199](contracts/bridge/WormholeCCTPAdapter.sol#L199)

	```solidity
	    function setRefundAddress(address _refundAddress) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/bridge/WormholeCCTPAdapter.sol [Line: 208](contracts/bridge/WormholeCCTPAdapter.sol#L208)

	```solidity
	    ) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/bridge/WormholeCCTPAdapter.sol [Line: 222](contracts/bridge/WormholeCCTPAdapter.sol#L222)

	```solidity
	    function removeChain(uint16 folksChainId) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/bridge/WormholeDataAdapter.sol [Line: 135](contracts/bridge/WormholeDataAdapter.sol#L135)

	```solidity
	    function setRefundAddress(address _refundAddress) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/bridge/WormholeDataAdapter.sol [Line: 143](contracts/bridge/WormholeDataAdapter.sol#L143)

	```solidity
	    ) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/bridge/WormholeDataAdapter.sol [Line: 157](contracts/bridge/WormholeDataAdapter.sol#L157)

	```solidity
	    function removeChain(uint16 folksChainId) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/hub/AccountManager.sol [Line: 40](contracts/hub/AccountManager.sol#L40)

	```solidity
	    ) external override onlyRole(HUB_ROLE) {
	```

- Found in contracts/hub/AccountManager.sol [Line: 71](contracts/hub/AccountManager.sol#L71)

	```solidity
	    ) external override onlyRole(HUB_ROLE) {
	```

- Found in contracts/hub/AccountManager.sol [Line: 101](contracts/hub/AccountManager.sol#L101)

	```solidity
	    function acceptInviteAddress(bytes32 accountId, uint16 chainId, bytes32 addr) external override onlyRole(HUB_ROLE) {
	```

- Found in contracts/hub/AccountManager.sol [Line: 123](contracts/hub/AccountManager.sol#L123)

	```solidity
	    function unregisterAddress(bytes32 accountId, uint16 unregisterChainId) external override onlyRole(HUB_ROLE) {
	```

- Found in contracts/hub/AccountManager.sol [Line: 146](contracts/hub/AccountManager.sol#L146)

	```solidity
	    function addDelegate(bytes32 accountId, address addr) external override onlyRole(HUB_ROLE) {
	```

- Found in contracts/hub/AccountManager.sol [Line: 162](contracts/hub/AccountManager.sol#L162)

	```solidity
	    function removeDelegate(bytes32 accountId, address addr) external override onlyRole(HUB_ROLE) {
	```

- Found in contracts/hub/HubCircleTokenPool.sol [Line: 31](contracts/hub/HubCircleTokenPool.sol#L31)

	```solidity
	    function addChainSpoke(uint16 chainId, bytes32 spokeAddress) external onlyRole(PARAM_ROLE) {
	```

- Found in contracts/hub/HubCircleTokenPool.sol [Line: 35](contracts/hub/HubCircleTokenPool.sol#L35)

	```solidity
	    function removeChainSpoke(uint16 chainId) external onlyRole(PARAM_ROLE) {
	```

- Found in contracts/hub/HubPool.sol [Line: 58](contracts/hub/HubPool.sol#L58)

	```solidity
	    function clearTokenFees() external override onlyRole(HUB_ROLE) nonReentrant returns (uint256) {
	```

- Found in contracts/hub/HubPool.sol [Line: 81](contracts/hub/HubPool.sol#L81)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant returns (Messages.MessageToSend memory) {
	```

- Found in contracts/hub/HubPool.sol [Line: 129](contracts/hub/HubPool.sol#L129)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant returns (DataTypes.DepositPoolParams memory) {
	```

- Found in contracts/hub/HubPool.sol [Line: 137](contracts/hub/HubPool.sol#L137)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant returns (DataTypes.WithdrawPoolParams memory) {
	```

- Found in contracts/hub/HubPool.sol [Line: 141](contracts/hub/HubPool.sol#L141)

	```solidity
	    function preparePoolForWithdrawFToken() external view override onlyRole(LOAN_MANAGER_ROLE) {
	```

- Found in contracts/hub/HubPool.sol [Line: 151](contracts/hub/HubPool.sol#L151)

	```solidity
	        onlyRole(LOAN_MANAGER_ROLE)
	```

- Found in contracts/hub/HubPool.sol [Line: 162](contracts/hub/HubPool.sol#L162)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 169](contracts/hub/HubPool.sol#L169)

	```solidity
	        onlyRole(LOAN_MANAGER_ROLE)
	```

- Found in contracts/hub/HubPool.sol [Line: 181](contracts/hub/HubPool.sol#L181)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 192](contracts/hub/HubPool.sol#L192)

	```solidity
	        onlyRole(LOAN_MANAGER_ROLE)
	```

- Found in contracts/hub/HubPool.sol [Line: 199](contracts/hub/HubPool.sol#L199)

	```solidity
	    function updatePoolWithLiquidation() external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 209](contracts/hub/HubPool.sol#L209)

	```solidity
	        onlyRole(LOAN_MANAGER_ROLE)
	```

- Found in contracts/hub/HubPool.sol [Line: 220](contracts/hub/HubPool.sol#L220)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 232](contracts/hub/HubPool.sol#L232)

	```solidity
	        onlyRole(LOAN_MANAGER_ROLE)
	```

- Found in contracts/hub/HubPool.sol [Line: 242](contracts/hub/HubPool.sol#L242)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 249](contracts/hub/HubPool.sol#L249)

	```solidity
	        onlyRole(LOAN_MANAGER_ROLE)
	```

- Found in contracts/hub/HubPool.sol [Line: 259](contracts/hub/HubPool.sol#L259)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 263](contracts/hub/HubPool.sol#L263)

	```solidity
	    function mintFTokenForFeeRecipient(uint256 amount) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 267](contracts/hub/HubPool.sol#L267)

	```solidity
	    function mintFToken(address recipient, uint256 amount) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 271](contracts/hub/HubPool.sol#L271)

	```solidity
	    function burnFToken(address sender, uint256 amount) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPoolState.sol [Line: 174](contracts/hub/HubPoolState.sol#L174)

	```solidity
	    ) external onlyRole(PARAM_ROLE) {
	```

- Found in contracts/hub/HubPoolState.sol [Line: 185](contracts/hub/HubPoolState.sol#L185)

	```solidity
	    function updateDepositData(uint16 optimalUtilisationRatio) external onlyRole(PARAM_ROLE) {
	```

- Found in contracts/hub/HubPoolState.sol [Line: 192](contracts/hub/HubPoolState.sol#L192)

	```solidity
	    function updateVariableBorrowData(uint32 vr0, uint32 vr1, uint32 vr2) external onlyRole(PARAM_ROLE) {
	```

- Found in contracts/hub/HubPoolState.sol [Line: 210](contracts/hub/HubPoolState.sol#L210)

	```solidity
	    ) external onlyRole(PARAM_ROLE) {
	```

- Found in contracts/hub/HubPoolState.sol [Line: 224](contracts/hub/HubPoolState.sol#L224)

	```solidity
	    function updateCapsData(CapsData memory capsData) external onlyRole(PARAM_ROLE) {
	```

- Found in contracts/hub/HubPoolState.sol [Line: 229](contracts/hub/HubPoolState.sol#L229)

	```solidity
	    function updateConfigData(ConfigData memory configData) external onlyRole(PARAM_ROLE) {
	```

- Found in contracts/hub/HubPoolState.sol [Line: 237](contracts/hub/HubPoolState.sol#L237)

	```solidity
	    function updateOracleManager(IOracleManager newOracleManager) external onlyRole(ORACLE_ROLE) {
	```

- Found in contracts/hub/LoanManager.sol [Line: 45](contracts/hub/LoanManager.sol#L45)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 60](contracts/hub/LoanManager.sol#L60)

	```solidity
	    function deleteUserLoan(bytes32 loanId, bytes32 accountId) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 79](contracts/hub/LoanManager.sol#L79)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 98](contracts/hub/LoanManager.sol#L98)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 118](contracts/hub/LoanManager.sol#L118)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant returns (uint256 underlingAmount) {
	```

- Found in contracts/hub/LoanManager.sol [Line: 144](contracts/hub/LoanManager.sol#L144)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 169](contracts/hub/LoanManager.sol#L169)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 194](contracts/hub/LoanManager.sol#L194)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 217](contracts/hub/LoanManager.sol#L217)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 241](contracts/hub/LoanManager.sol#L241)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 271](contracts/hub/LoanManager.sol#L271)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 117](contracts/hub/LoanManagerState.sol#L117)

	```solidity
	    function updateOracleManager(IOracleManager newOracleManager) external onlyRole(ORACLE_ROLE) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 125](contracts/hub/LoanManagerState.sol#L125)

	```solidity
	    function createLoanType(uint16 loanTypeId, uint32 loanTargetHealth) external onlyRole(LISTING_ROLE) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 140](contracts/hub/LoanManagerState.sol#L140)

	```solidity
	    function deprecateLoanType(uint16 loanTypeId) external onlyRole(LISTING_ROLE) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 151](contracts/hub/LoanManagerState.sol#L151)

	```solidity
	    ) external onlyRole(LISTING_ROLE) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 163](contracts/hub/LoanManagerState.sol#L163)

	```solidity
	    function addPool(IHubPool pool) external onlyRole(LISTING_ROLE) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 190](contracts/hub/LoanManagerState.sol#L190)

	```solidity
	    ) external onlyRole(LISTING_ROLE) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 228](contracts/hub/LoanManagerState.sol#L228)

	```solidity
	    function deprecatePoolInLoanType(uint16 loanTypeId, uint8 poolId) external onlyRole(LISTING_ROLE) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 242](contracts/hub/LoanManagerState.sol#L242)

	```solidity
	    ) external onlyRole(LISTING_ROLE) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 255](contracts/hub/LoanManagerState.sol#L255)

	```solidity
	    ) external onlyRole(LISTING_ROLE) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 268](contracts/hub/LoanManagerState.sol#L268)

	```solidity
	    ) external onlyRole(LISTING_ROLE) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 282](contracts/hub/LoanManagerState.sol#L282)

	```solidity
	    ) external onlyRole(LISTING_ROLE) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 298](contracts/hub/LoanManagerState.sol#L298)

	```solidity
	    ) external onlyRole(LISTING_ROLE) {
	```

- Found in contracts/hub/OracleManager.sol [Line: 27](contracts/hub/OracleManager.sol#L27)

	```solidity
	    function setNodeManager(address nodeManager) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/hub/OracleManager.sol [Line: 32](contracts/hub/OracleManager.sol#L32)

	```solidity
	    function setNodeId(uint8 poolId, bytes32 nodeId, uint8 decimals) external onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/hub/SpokeManager.sol [Line: 20](contracts/hub/SpokeManager.sol#L20)

	```solidity
	    function activateSpoke(uint16 chainId, bytes32 addr) external override onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/hub/SpokeManager.sol [Line: 26](contracts/hub/SpokeManager.sol#L26)

	```solidity
	    function depreciateSpoke(uint16 chainId, bytes32 addr) external override onlyRole(MANAGER_ROLE) {
	```

- Found in contracts/spoke/RateLimited.sol [Line: 41](contracts/spoke/RateLimited.sol#L41)

	```solidity
	    function setBucketConfig(BucketConfig memory newBucketConfig) external onlyRole(CONFIG_RATE_LIMIT_ROLE) {
	```

- Found in contracts/spoke/RateLimited.sol [Line: 45](contracts/spoke/RateLimited.sol#L45)

	```solidity
	    function boostCapacity(uint256 amount) external onlyRole(BOOST_RATE_LIMIT_ROLE) {
	```

- Found in contracts/spoke/SpokeState.sol [Line: 29](contracts/spoke/SpokeState.sol#L29)

	```solidity
	    function setHub(uint16 chainId, bytes32 contractAddress) external onlyRole(CONFIG_CONTRACTS_ROLE) {
	```

- Found in contracts/spoke/SpokeState.sol [Line: 33](contracts/spoke/SpokeState.sol#L33)

	```solidity
	    function setAddressOracle(IAddressOracle newAddressOracle) external onlyRole(CONFIG_CONTRACTS_ROLE) {
	```



## M-2: Using `ERC721::_mint()` can be dangerous

Using `ERC721::_mint()` can mint ERC721 tokens to addresses which don't support ERC721 tokens. Use `_safeMint()` instead of `_mint()` for ERC721.

- Found in contracts/hub/HubPool.sol [Line: 264](contracts/hub/HubPool.sol#L264)

	```solidity
	        return _mint(_poolData.feeData.fTokenFeeRecipient, amount);
	```

- Found in contracts/hub/HubPool.sol [Line: 268](contracts/hub/HubPool.sol#L268)

	```solidity
	        return _mint(recipient, amount);
	```



# Low Issues

## L-1: Unsafe ERC20 Operations should not be used

ERC20 functions may not behave as expected. For example: return values are not always meaningful. It is recommended to use OpenZeppelin's SafeERC20 library.

- Found in contracts/bridge/CCIPTokenAdapter.sol [Line: 61](contracts/bridge/CCIPTokenAdapter.sol#L61)

	```solidity
	        IERC20(token).approve(address(ccipRouter), extraArgs.amount);
	```

- Found in contracts/bridge/WormholeCCTPAdapter.sol [Line: 253](contracts/bridge/WormholeCCTPAdapter.sol#L253)

	```solidity
	        IERC20(circleToken).approve(address(circleTokenMessenger), amount);
	```



## L-2: Solidity pragma should be specific, not wide

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

- Found in contracts/oracle/interfaces/IExternalNode.sol [Line: 2](contracts/oracle/interfaces/IExternalNode.sol#L2)

	```solidity
	pragma solidity >=0.8.11 <0.9.0;
	```

- Found in contracts/oracle/storage/NodeDefinition.sol [Line: 2](contracts/oracle/storage/NodeDefinition.sol#L2)

	```solidity
	pragma solidity >=0.8.11 <0.9.0;
	```

- Found in contracts/oracle/storage/NodeOutput.sol [Line: 2](contracts/oracle/storage/NodeOutput.sol#L2)

	```solidity
	pragma solidity >=0.8.11 <0.9.0;
	```



## L-3: Conditional storage checks are not consistent

When writing `require` or `if` conditionals that check storage values, it is important to be consistent to prevent off-by-one errors. There are instances found where the same storage variable is checked multiple times, but the conditionals are not consistent.

- Found in contracts/hub/libraries/MathUtils.sol [Line: 121](contracts/hub/libraries/MathUtils.sol#L121)

	```solidity
	                        ONE_4_DP - optimalUtilisationRatio
	```

- Found in contracts/hub/libraries/MathUtils.sol [Line: 226](contracts/hub/libraries/MathUtils.sol#L226)

	```solidity
	                exponentialBySquaring(ONE_18_DP + (borrowInterestRateAtT_1 / SECONDS_IN_YEAR), timeDelta, ONE_18_DP),
	```

- Found in contracts/hub/libraries/MathUtils.sol [Line: 403](contracts/hub/libraries/MathUtils.sol#L403)

	```solidity
	        return (ONE_4_DP + rebalanceDownDelta).mulDiv(stableBorrowInterestRateAtT_1, ONE_4_DP);
	```

- Found in contracts/hub/libraries/MathUtils.sol [Line: 565](contracts/hub/libraries/MathUtils.sol#L565)

	```solidity
	        return value * ONE_18_DP;
	```

- Found in contracts/oracle/nodes/ChainlinkNode.sol [Line: 36](contracts/oracle/nodes/ChainlinkNode.sol#L36)

	```solidity
	        price = decimals > PRECISION ? price / (10 ** (decimals - PRECISION)) : price * (10 ** (PRECISION - decimals));
	```

- Found in contracts/spoke/RateLimited.sol [Line: 77](contracts/spoke/RateLimited.sol#L77)

	```solidity
	        if (currentCapacity < amount) revert InsufficientCapacity(currentCapacity, amount);
	```

- Found in contracts/spoke/RateLimited.sol [Line: 88](contracts/spoke/RateLimited.sol#L88)

	```solidity
	            uint256 newCapacity = currentCapacity + amount;
	```

- Found in contracts/spoke/RateLimited.sol [Line: 89](contracts/spoke/RateLimited.sol#L89)

	```solidity
	            currentCapacity = newCapacity < currentCapacity ? type(uint256).max : newCapacity;
	```



## L-4: PUSH0 is not supported by all chains

Solc compiler version 0.8.20 switches the default target EVM version to Shanghai, which means that the generated bytecode will include PUSH0 opcodes. Be sure to select the appropriate EVM version in case you intend to deploy on a chain other than mainnet like L2 chains that may not support PUSH0, otherwise deployment of your contracts will fail.

- Found in contracts/oracle/interfaces/IExternalNode.sol [Line: 2](contracts/oracle/interfaces/IExternalNode.sol#L2)

	```solidity
	pragma solidity >=0.8.11 <0.9.0;
	```

- Found in contracts/oracle/storage/NodeDefinition.sol [Line: 2](contracts/oracle/storage/NodeDefinition.sol#L2)

	```solidity
	pragma solidity >=0.8.11 <0.9.0;
	```

- Found in contracts/oracle/storage/NodeOutput.sol [Line: 2](contracts/oracle/storage/NodeOutput.sol#L2)

	```solidity
	pragma solidity >=0.8.11 <0.9.0;
	```



# NC Issues

## NC-1: Missing checks for `address(0)` when assigning values to address state variables

Assigning values to address state variables without checking for `address(0)`.

- Found in contracts/bridge/WormholeCCTPAdapter.sol [Line: 83](contracts/bridge/WormholeCCTPAdapter.sol#L83)

	```solidity
	        refundAddress = _refundAddress;
	```

- Found in contracts/bridge/WormholeCCTPAdapter.sol [Line: 200](contracts/bridge/WormholeCCTPAdapter.sol#L200)

	```solidity
	        refundAddress = _refundAddress;
	```

- Found in contracts/bridge/WormholeDataAdapter.sol [Line: 57](contracts/bridge/WormholeDataAdapter.sol#L57)

	```solidity
	        refundAddress = _refundAddress;
	```

- Found in contracts/bridge/WormholeDataAdapter.sol [Line: 136](contracts/bridge/WormholeDataAdapter.sol#L136)

	```solidity
	        refundAddress = _refundAddress;
	```

- Found in contracts/hub/HubPoolState.sol [Line: 119](contracts/hub/HubPoolState.sol#L119)

	```solidity
	        _oracleManager = oracleManager_;
	```

- Found in contracts/hub/HubPoolState.sol [Line: 238](contracts/hub/HubPoolState.sol#L238)

	```solidity
	        _oracleManager = newOracleManager;
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 106](contracts/hub/LoanManagerState.sol#L106)

	```solidity
	        _oracleManager = oracleManager_;
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 118](contracts/hub/LoanManagerState.sol#L118)

	```solidity
	        _oracleManager = newOracleManager;
	```

- Found in contracts/spoke/SpokeState.sol [Line: 42](contracts/spoke/SpokeState.sol#L42)

	```solidity
	        _addressOracle = newAddressOracle;
	```



## NC-2: Functions not used internally could be marked external



- Found in contracts/bridge/BridgeMessenger.sol [Line: 36](contracts/bridge/BridgeMessenger.sol#L36)

	```solidity
	    function getBridgeRouter() public view returns (address) {
	```

- Found in contracts/bridge/CCIPAdapter.sol [Line: 93](contracts/bridge/CCIPAdapter.sol#L93)

	```solidity
	    function supportsInterface(
	```

- Found in contracts/hub/AccountManager.sol [Line: 251](contracts/hub/AccountManager.sol#L251)

	```solidity
	    function isAddressRegisteredToAccount(
	```

- Found in contracts/hub/HubPool.sol [Line: 275](contracts/hub/HubPool.sol#L275)

	```solidity
	    function decimals() public view override returns (uint8) {
	```

- Found in contracts/hub/HubPool.sol [Line: 279](contracts/hub/HubPool.sol#L279)

	```solidity
	    function maxFlashLoan(address token) public view override returns (uint256) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 390](contracts/hub/LoanManagerState.sol#L390)

	```solidity
	    function getLoanTypeLoanTargetHealth(uint16 loanTypeId) public view returns (uint256) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 421](contracts/hub/LoanManagerState.sol#L421)

	```solidity
	    function getType(bytes32 loanId) public view returns (uint16) {
	```

- Found in contracts/hub/logic/LoanManagerLogic.sol [Line: 161](contracts/hub/logic/LoanManagerLogic.sol#L161)

	```solidity
	    function executeWithdraw(
	```

- Found in contracts/hub/logic/LoanManagerLogic.sol [Line: 313](contracts/hub/logic/LoanManagerLogic.sol#L313)

	```solidity
	    function executeRepay(
	```

- Found in contracts/spoke/SpokeState.sol [Line: 45](contracts/spoke/SpokeState.sol#L45)

	```solidity
	    function getHubChainId() public view returns (uint16) {
	```

- Found in contracts/spoke/SpokeState.sol [Line: 49](contracts/spoke/SpokeState.sol#L49)

	```solidity
	    function getHubContractAddress() public view returns (bytes32) {
	```

- Found in contracts/spoke/SpokeState.sol [Line: 53](contracts/spoke/SpokeState.sol#L53)

	```solidity
	    function getAddressOracle() public view returns (address) {
	```



## NC-3: Constants should be defined and used instead of literals



- Found in contracts/bridge/BridgeRouter.sol [Line: 39](contracts/bridge/BridgeRouter.sol#L39)

	```solidity
	    constructor(address admin) AccessControlDefaultAdminRules(1 days, admin) {
	```

- Found in contracts/bridge/BridgeRouter.sol [Line: 187](contracts/bridge/BridgeRouter.sol#L187)

	```solidity
	        return (address(adapter) != address(0x0));
	```

- Found in contracts/bridge/CCIPAdapter.sol [Line: 39](contracts/bridge/CCIPAdapter.sol#L39)

	```solidity
	    ) AccessControlDefaultAdminRules(1 days, admin) CCIPReceiver(address(ccipRouter_)) {
	```

- Found in contracts/bridge/CCIPTokenAdapter.sol [Line: 86](contracts/bridge/CCIPTokenAdapter.sol#L86)

	```solidity
	        if (message.destTokenAmounts.length != 1) revert InvalidDestTokenAmountsLength();
	```

- Found in contracts/bridge/CCIPTokenAdapter.sol [Line: 131](contracts/bridge/CCIPTokenAdapter.sol#L131)

	```solidity
	        Client.EVMTokenAmount[] memory tokenAmounts = new Client.EVMTokenAmount[](1);
	```

- Found in contracts/bridge/HubAdapter.sol [Line: 49](contracts/bridge/HubAdapter.sol#L49)

	```solidity
	        sequence += 1;
	```

- Found in contracts/bridge/WormholeCCTPAdapter.sol [Line: 78](contracts/bridge/WormholeCCTPAdapter.sol#L78)

	```solidity
	    ) AccessControlDefaultAdminRules(1 days, admin) {
	```

- Found in contracts/bridge/WormholeCCTPAdapter.sol [Line: 174](contracts/bridge/WormholeCCTPAdapter.sol#L174)

	```solidity
	        if (additionalMessages.length != 1) revert InvalidAdditionalMessagesLength();
	```

- Found in contracts/bridge/WormholeCCTPAdapter.sol [Line: 263](contracts/bridge/WormholeCCTPAdapter.sol#L263)

	```solidity
	        MessageKey[] memory messageKeys = new MessageKey[](1);
	```

- Found in contracts/bridge/WormholeDataAdapter.sol [Line: 54](contracts/bridge/WormholeDataAdapter.sol#L54)

	```solidity
	    ) AccessControlDefaultAdminRules(1 days, admin) {
	```

- Found in contracts/bridge/libraries/CCIPTokenMessages.sol [Line: 42](contracts/bridge/libraries/CCIPTokenMessages.sol#L42)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/CCIPTokenMessages.sol [Line: 44](contracts/bridge/libraries/CCIPTokenMessages.sol#L44)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/CCIPTokenMessages.sol [Line: 46](contracts/bridge/libraries/CCIPTokenMessages.sol#L46)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/CCIPTokenMessages.sol [Line: 50](contracts/bridge/libraries/CCIPTokenMessages.sol#L50)

	```solidity
	        index += 2;
	```

- Found in contracts/bridge/libraries/CCIPTokenMessages.sol [Line: 52](contracts/bridge/libraries/CCIPTokenMessages.sol#L52)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/CCIPTokenMessages.sol [Line: 54](contracts/bridge/libraries/CCIPTokenMessages.sol#L54)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/CCIPTokenMessages.sol [Line: 56](contracts/bridge/libraries/CCIPTokenMessages.sol#L56)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/CCTPMessages.sol [Line: 45](contracts/bridge/libraries/CCTPMessages.sol#L45)

	```solidity
	        index += 4;
	```

- Found in contracts/bridge/libraries/CCTPMessages.sol [Line: 47](contracts/bridge/libraries/CCTPMessages.sol#L47)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/CCTPMessages.sol [Line: 49](contracts/bridge/libraries/CCTPMessages.sol#L49)

	```solidity
	        index += 8;
	```

- Found in contracts/bridge/libraries/CCTPMessages.sol [Line: 51](contracts/bridge/libraries/CCTPMessages.sol#L51)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/CCTPMessages.sol [Line: 55](contracts/bridge/libraries/CCTPMessages.sol#L55)

	```solidity
	        index += 2;
	```

- Found in contracts/bridge/libraries/CCTPMessages.sol [Line: 57](contracts/bridge/libraries/CCTPMessages.sol#L57)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/CCTPMessages.sol [Line: 59](contracts/bridge/libraries/CCTPMessages.sol#L59)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/CCTPMessages.sol [Line: 61](contracts/bridge/libraries/CCTPMessages.sol#L61)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/CCTPMessages.sol [Line: 68](contracts/bridge/libraries/CCTPMessages.sol#L68)

	```solidity
	        uint256 cctp_nonce_index = 12;
	```

- Found in contracts/bridge/libraries/Messages.sol [Line: 44](contracts/bridge/libraries/Messages.sol#L44)

	```solidity
	            extraArgs = abi.decode(bts[4:], (Messages.ExtraArgsV1));
	```

- Found in contracts/bridge/libraries/Messages.sol [Line: 104](contracts/bridge/libraries/Messages.sol#L104)

	```solidity
	        index += 2;
	```

- Found in contracts/bridge/libraries/Messages.sol [Line: 106](contracts/bridge/libraries/Messages.sol#L106)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/Messages.sol [Line: 108](contracts/bridge/libraries/Messages.sol#L108)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/Messages.sol [Line: 135](contracts/bridge/libraries/Messages.sol#L135)

	```solidity
	        index += 2;
	```

- Found in contracts/bridge/libraries/Messages.sol [Line: 137](contracts/bridge/libraries/Messages.sol#L137)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/Messages.sol [Line: 139](contracts/bridge/libraries/Messages.sol#L139)

	```solidity
	        index += 32;
	```

- Found in contracts/bridge/libraries/Messages.sol [Line: 141](contracts/bridge/libraries/Messages.sol#L141)

	```solidity
	        index += 32;
	```

- Found in contracts/hub/AccountManager.sol [Line: 26](contracts/hub/AccountManager.sol#L26)

	```solidity
	    constructor(address admin) AccessControlDefaultAdminRules(1 days, admin) {}
	```

- Found in contracts/hub/Hub.sol [Line: 95](contracts/hub/Hub.sol#L95)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 97](contracts/hub/Hub.sol#L97)

	```solidity
	            index += 1;
	```

- Found in contracts/hub/Hub.sol [Line: 103](contracts/hub/Hub.sol#L103)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 105](contracts/hub/Hub.sol#L105)

	```solidity
	            index += 1;
	```

- Found in contracts/hub/Hub.sol [Line: 111](contracts/hub/Hub.sol#L111)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 113](contracts/hub/Hub.sol#L113)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 115](contracts/hub/Hub.sol#L115)

	```solidity
	            index += 1;
	```

- Found in contracts/hub/Hub.sol [Line: 117](contracts/hub/Hub.sol#L117)

	```solidity
	            index += 1;
	```

- Found in contracts/hub/Hub.sol [Line: 119](contracts/hub/Hub.sol#L119)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 121](contracts/hub/Hub.sol#L121)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 166](contracts/hub/Hub.sol#L166)

	```solidity
	            index += 2;
	```

- Found in contracts/hub/Hub.sol [Line: 168](contracts/hub/Hub.sol#L168)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 188](contracts/hub/Hub.sol#L188)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 190](contracts/hub/Hub.sol#L190)

	```solidity
	            index += 2;
	```

- Found in contracts/hub/Hub.sol [Line: 200](contracts/hub/Hub.sol#L200)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 202](contracts/hub/Hub.sol#L202)

	```solidity
	            index += 1;
	```

- Found in contracts/hub/Hub.sol [Line: 204](contracts/hub/Hub.sol#L204)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 206](contracts/hub/Hub.sol#L206)

	```solidity
	            index += 2;
	```

- Found in contracts/hub/Hub.sol [Line: 216](contracts/hub/Hub.sol#L216)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 218](contracts/hub/Hub.sol#L218)

	```solidity
	            index += 1;
	```

- Found in contracts/hub/Hub.sol [Line: 227](contracts/hub/Hub.sol#L227)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 229](contracts/hub/Hub.sol#L229)

	```solidity
	            index += 1;
	```

- Found in contracts/hub/Hub.sol [Line: 231](contracts/hub/Hub.sol#L231)

	```solidity
	            index += 2;
	```

- Found in contracts/hub/Hub.sol [Line: 233](contracts/hub/Hub.sol#L233)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 243](contracts/hub/Hub.sol#L243)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 245](contracts/hub/Hub.sol#L245)

	```solidity
	            index += 1;
	```

- Found in contracts/hub/Hub.sol [Line: 247](contracts/hub/Hub.sol#L247)

	```solidity
	            index += 2;
	```

- Found in contracts/hub/Hub.sol [Line: 249](contracts/hub/Hub.sol#L249)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 258](contracts/hub/Hub.sol#L258)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 260](contracts/hub/Hub.sol#L260)

	```solidity
	            index += 1;
	```

- Found in contracts/hub/Hub.sol [Line: 262](contracts/hub/Hub.sol#L262)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 271](contracts/hub/Hub.sol#L271)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 273](contracts/hub/Hub.sol#L273)

	```solidity
	            index += 1;
	```

- Found in contracts/hub/Hub.sol [Line: 279](contracts/hub/Hub.sol#L279)

	```solidity
	            index += 32;
	```

- Found in contracts/hub/Hub.sol [Line: 281](contracts/hub/Hub.sol#L281)

	```solidity
	            index += 1;
	```

- Found in contracts/hub/Hub.sol [Line: 324](contracts/hub/Hub.sol#L324)

	```solidity
	        uint256 index = 32;
	```

- Found in contracts/hub/Hub.sol [Line: 326](contracts/hub/Hub.sol#L326)

	```solidity
	        index += 1;
	```

- Found in contracts/hub/HubPool.sol [Line: 110](contracts/hub/HubPool.sol#L110)

	```solidity
	                finalityLevel: 1, // finalised
	```

- Found in contracts/hub/HubPoolState.sol [Line: 104](contracts/hub/HubPoolState.sol#L104)

	```solidity
	    ) AccessControlDefaultAdminRules(1 days, admin) {
	```

- Found in contracts/hub/HubPoolState.sol [Line: 249](contracts/hub/HubPoolState.sol#L249)

	```solidity
	        if (_poolData.feeData.flashLoanFee > 1e5) revert FlashLoanFeeTooHigh();
	```

- Found in contracts/hub/HubPoolState.sol [Line: 252](contracts/hub/HubPoolState.sol#L252)

	```solidity
	        if (_poolData.feeData.retentionRate > 1e6) revert RetentionRateTooHigh();
	```

- Found in contracts/hub/HubPoolState.sol [Line: 258](contracts/hub/HubPoolState.sol#L258)

	```solidity
	        if (_poolData.depositData.optimalUtilisationRatio >= 1e4) revert OptimalUtilisationRatioTooHigh();
	```

- Found in contracts/hub/HubPoolState.sol [Line: 265](contracts/hub/HubPoolState.sol#L265)

	```solidity
	            100e6
	```

- Found in contracts/hub/HubPoolState.sol [Line: 277](contracts/hub/HubPoolState.sol#L277)

	```solidity
	            100e6
	```

- Found in contracts/hub/HubPoolState.sol [Line: 281](contracts/hub/HubPoolState.sol#L281)

	```solidity
	        if (_poolData.stableBorrowData.optimalStableToTotalDebtRatio >= 1e4)
	```

- Found in contracts/hub/HubPoolState.sol [Line: 285](contracts/hub/HubPoolState.sol#L285)

	```solidity
	        if (_poolData.stableBorrowData.rebalanceUpUtilisationRatio > 1e4) revert RebalanceUpUtilisationRatioTooHigh();
	```

- Found in contracts/hub/HubPoolState.sol [Line: 288](contracts/hub/HubPoolState.sol#L288)

	```solidity
	        if (_poolData.stableBorrowData.rebalanceUpDepositInterestRate > 1e4)
	```

- Found in contracts/hub/HubPoolState.sol [Line: 294](contracts/hub/HubPoolState.sol#L294)

	```solidity
	        if (_poolData.capsData.stableBorrowPercentage > 1e18) revert StableBorrowPercentageTooHigh();
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 104](contracts/hub/LoanManagerState.sol#L104)

	```solidity
	    constructor(address admin, IOracleManager oracleManager_) AccessControlDefaultAdminRules(1 days, admin) {
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 427](contracts/hub/LoanManagerState.sol#L427)

	```solidity
	        if (loanTargetHealth < 1e4) revert LoanTargetHealthTooLow();
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 432](contracts/hub/LoanManagerState.sol#L432)

	```solidity
	        if (collateralFactor > 1e4) revert CollateralFactorTooHigh();
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 437](contracts/hub/LoanManagerState.sol#L437)

	```solidity
	        if (borrowFactor < 1e4) revert BorrowFactorTooLow();
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 442](contracts/hub/LoanManagerState.sol#L442)

	```solidity
	        if (liquidationBonus > 1e4) revert LiquidationBonusTooHigh();
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 444](contracts/hub/LoanManagerState.sol#L444)

	```solidity
	        if (liquidationFee > 1e4) revert LiquidationFeeTooHigh();
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 449](contracts/hub/LoanManagerState.sol#L449)

	```solidity
	        Math.mulDiv(collateralSpeed, 36525 days, minimumAmount);
	```

- Found in contracts/hub/LoanManagerState.sol [Line: 450](contracts/hub/LoanManagerState.sol#L450)

	```solidity
	        Math.mulDiv(borrowSpeed, 36525 days, minimumAmount);
	```

- Found in contracts/hub/OracleManager.sol [Line: 22](contracts/hub/OracleManager.sol#L22)

	```solidity
	    constructor(address admin, address nodeManager) AccessControlDefaultAdminRules(1 days, admin) {
	```

- Found in contracts/hub/SpokeManager.sol [Line: 16](contracts/hub/SpokeManager.sol#L16)

	```solidity
	    constructor(address admin) AccessControlDefaultAdminRules(1 days, admin) {
	```

- Found in contracts/hub/libraries/MathUtils.sol [Line: 23](contracts/hub/libraries/MathUtils.sol#L23)

	```solidity
	        return amount.mulDiv(price, 10 ** decimals);
	```

- Found in contracts/hub/libraries/MathUtils.sol [Line: 36](contracts/hub/libraries/MathUtils.sol#L36)

	```solidity
	        return amount.mulDiv(price, 10 ** decimals, Math.Rounding.Ceil);
	```

- Found in contracts/hub/libraries/MathUtils.sol [Line: 45](contracts/hub/libraries/MathUtils.sol#L45)

	```solidity
	        return amountValue.mulDiv(10 ** decimals, price);
	```

- Found in contracts/hub/libraries/MathUtils.sol [Line: 62](contracts/hub/libraries/MathUtils.sol#L62)

	```solidity
	        return calcAssetDollarValue(amountFrom, priceFrom, decimalsFrom).mulDiv(10 ** decimalsTo, priceTo);
	```

- Found in contracts/hub/libraries/MathUtils.sol [Line: 205](contracts/hub/libraries/MathUtils.sol#L205)

	```solidity
	        z = n % 2 != 0 ? x : scale;
	```

- Found in contracts/hub/libraries/MathUtils.sol [Line: 206](contracts/hub/libraries/MathUtils.sol#L206)

	```solidity
	        for (n /= 2; n != 0; n /= 2) {
	```

- Found in contracts/hub/libraries/MathUtils.sol [Line: 208](contracts/hub/libraries/MathUtils.sol#L208)

	```solidity
	            if (n % 2 != 0) {
	```

- Found in contracts/hub/logic/UserLoanLogic.sol [Line: 40](contracts/hub/logic/UserLoanLogic.sol#L40)

	```solidity
	                    loan.colPools[i] = loan.colPools[colPoolsLength - 1];
	```

- Found in contracts/hub/logic/UserLoanLogic.sol [Line: 339](contracts/hub/logic/UserLoanLogic.sol#L339)

	```solidity
	                loan.borPools[i] = loan.borPools[borPoolsLength - 1];
	```

- Found in contracts/oracle/nodes/ChainlinkNode.sol [Line: 36](contracts/oracle/nodes/ChainlinkNode.sol#L36)

	```solidity
	        price = decimals > PRECISION ? price / (10 ** (decimals - PRECISION)) : price * (10 ** (PRECISION - decimals));
	```

- Found in contracts/oracle/nodes/ChainlinkNode.sol [Line: 54](contracts/oracle/nodes/ChainlinkNode.sol#L54)

	```solidity
	        uint256 priceCount = 1;
	```

- Found in contracts/oracle/nodes/ChainlinkNode.sol [Line: 85](contracts/oracle/nodes/ChainlinkNode.sol#L85)

	```solidity
	        if (nodeDefinition.parents.length > 0 || nodeDefinition.parameters.length != 32 * 3) {
	```

- Found in contracts/oracle/nodes/ConstantNode.sol [Line: 21](contracts/oracle/nodes/ConstantNode.sol#L21)

	```solidity
	        return (nodeDefinition.parents.length == 0 && nodeDefinition.parameters.length == 32);
	```

- Found in contracts/oracle/nodes/ExternalNode.sol [Line: 28](contracts/oracle/nodes/ExternalNode.sol#L28)

	```solidity
	        if (nodeDefinition.parameters.length != 32) {
	```

- Found in contracts/oracle/nodes/PriceDeviationCircuitBreakerNode.sol [Line: 28](contracts/oracle/nodes/PriceDeviationCircuitBreakerNode.sol#L28)

	```solidity
	        uint256 comparisonPrice = parentNodeOutputs[1].price;
	```

- Found in contracts/oracle/nodes/PriceDeviationCircuitBreakerNode.sol [Line: 34](contracts/oracle/nodes/PriceDeviationCircuitBreakerNode.sol#L34)

	```solidity
	            if (parentNodeOutputs.length == 2) revert DeviationToleranceExceeded(percentageDifference);
	```

- Found in contracts/oracle/nodes/PriceDeviationCircuitBreakerNode.sol [Line: 35](contracts/oracle/nodes/PriceDeviationCircuitBreakerNode.sol#L35)

	```solidity
	            return parentNodeOutputs[2];
	```

- Found in contracts/oracle/nodes/PriceDeviationCircuitBreakerNode.sol [Line: 47](contracts/oracle/nodes/PriceDeviationCircuitBreakerNode.sol#L47)

	```solidity
	            (nodeDefinition.parents.length > 1 && nodeDefinition.parents.length < 4) &&
	```

- Found in contracts/oracle/nodes/PriceDeviationCircuitBreakerNode.sol [Line: 48](contracts/oracle/nodes/PriceDeviationCircuitBreakerNode.sol#L48)

	```solidity
	            nodeDefinition.parameters.length == 32;
	```

- Found in contracts/oracle/nodes/PriceDeviationSameOracleCircuitBreakerNode.sol [Line: 30](contracts/oracle/nodes/PriceDeviationSameOracleCircuitBreakerNode.sol#L30)

	```solidity
	        uint256 comparisonPrice = parentNodeOutputs[1].price;
	```

- Found in contracts/oracle/nodes/PriceDeviationSameOracleCircuitBreakerNode.sol [Line: 35](contracts/oracle/nodes/PriceDeviationSameOracleCircuitBreakerNode.sol#L35)

	```solidity
	        if (parentNodeOutputs.length == 2 && parentNodeOutputs[0].nodeType == parentNodeOutputs[1].nodeType) {
	```

- Found in contracts/oracle/nodes/PriceDeviationSameOracleCircuitBreakerNode.sol [Line: 39](contracts/oracle/nodes/PriceDeviationSameOracleCircuitBreakerNode.sol#L39)

	```solidity
	            if (parentNodeOutputs.length == 2) revert DeviationToleranceExceeded(percentageDifference);
	```

- Found in contracts/oracle/nodes/PriceDeviationSameOracleCircuitBreakerNode.sol [Line: 40](contracts/oracle/nodes/PriceDeviationSameOracleCircuitBreakerNode.sol#L40)

	```solidity
	            return parentNodeOutputs[2];
	```

- Found in contracts/oracle/nodes/PriceDeviationSameOracleCircuitBreakerNode.sol [Line: 52](contracts/oracle/nodes/PriceDeviationSameOracleCircuitBreakerNode.sol#L52)

	```solidity
	            (nodeDefinition.parents.length > 1 && nodeDefinition.parents.length < 4) &&
	```

- Found in contracts/oracle/nodes/PriceDeviationSameOracleCircuitBreakerNode.sol [Line: 53](contracts/oracle/nodes/PriceDeviationSameOracleCircuitBreakerNode.sol#L53)

	```solidity
	            nodeDefinition.parameters.length == 32;
	```

- Found in contracts/oracle/nodes/PythNode.sol [Line: 35](contracts/oracle/nodes/PythNode.sol#L35)

	```solidity
	            ? pythData.price.toUint256() * (10 ** factor.toUint256())
	```

- Found in contracts/oracle/nodes/PythNode.sol [Line: 36](contracts/oracle/nodes/PythNode.sol#L36)

	```solidity
	            : pythData.price.toUint256() / (10 ** factor.toUint256());
	```

- Found in contracts/oracle/nodes/PythNode.sol [Line: 46](contracts/oracle/nodes/PythNode.sol#L46)

	```solidity
	        if (nodeDefinition.parents.length > 0 || nodeDefinition.parameters.length != 32 * 3) {
	```

- Found in contracts/oracle/nodes/ReducerNode.sol [Line: 51](contracts/oracle/nodes/ReducerNode.sol#L51)

	```solidity
	        return nodeDefinition.parents.length > 1 && operationId < uint256(Operation.COUNT);
	```

- Found in contracts/oracle/nodes/ReducerNode.sol [Line: 72](contracts/oracle/nodes/ReducerNode.sol#L72)

	```solidity
	        for (uint256 i = 1; i < parentNodeOutputs.length; i++) {
	```

- Found in contracts/oracle/nodes/ReducerNode.sol [Line: 84](contracts/oracle/nodes/ReducerNode.sol#L84)

	```solidity
	        for (uint256 i = 1; i < parentNodeOutputs.length; i++) {
	```

- Found in contracts/oracle/nodes/StalenessCircuitBreakerNode.sol [Line: 27](contracts/oracle/nodes/StalenessCircuitBreakerNode.sol#L27)

	```solidity
	        if (parentsNodeOutput.length == 2) {
	```

- Found in contracts/oracle/nodes/StalenessCircuitBreakerNode.sol [Line: 28](contracts/oracle/nodes/StalenessCircuitBreakerNode.sol#L28)

	```solidity
	            return parentsNodeOutput[1];
	```

- Found in contracts/oracle/nodes/StalenessCircuitBreakerNode.sol [Line: 41](contracts/oracle/nodes/StalenessCircuitBreakerNode.sol#L41)

	```solidity
	            nodeDefinition.parents.length < 3 &&
	```

- Found in contracts/oracle/nodes/StalenessCircuitBreakerNode.sol [Line: 42](contracts/oracle/nodes/StalenessCircuitBreakerNode.sol#L42)

	```solidity
	            nodeDefinition.parameters.length == 32;
	```

- Found in contracts/spoke/RateLimited.sol [Line: 53](contracts/spoke/RateLimited.sol#L53)

	```solidity
	        if (newBucketConfig.period < 1 hours) revert PeriodTooLow();
	```

- Found in contracts/spoke/RateLimited.sol [Line: 54](contracts/spoke/RateLimited.sol#L54)

	```solidity
	        if (newBucketConfig.period > 1 weeks) revert PeriodTooHigh();
	```

- Found in contracts/spoke/SpokeErc20Token.sol [Line: 46](contracts/spoke/SpokeErc20Token.sol#L46)

	```solidity
	        return IERC20(token).balanceOf(address(this)) / 100;
	```

- Found in contracts/spoke/SpokeGasToken.sol [Line: 41](contracts/spoke/SpokeGasToken.sol#L41)

	```solidity
	        return address(this).balance / 100;
	```

- Found in contracts/spoke/SpokeState.sol [Line: 23](contracts/spoke/SpokeState.sol#L23)

	```solidity
	    ) AccessControlDefaultAdminRules(1 days, admin) {
	```

- Found in contracts/spoke/SpokeToken.sol [Line: 134](contracts/spoke/SpokeToken.sol#L134)

	```solidity
	            finalityLevel: 1, // finalised
	```



## NC-4: Event is missing `indexed` fields

Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.

- Found in contracts/bridge/BridgeRouter.sol [Line: 14](contracts/bridge/BridgeRouter.sol#L14)

	```solidity
	    event MessageSucceeded(uint16 adapterId, bytes32 indexed messageId);
	```

- Found in contracts/bridge/BridgeRouter.sol [Line: 15](contracts/bridge/BridgeRouter.sol#L15)

	```solidity
	    event MessageFailed(uint16 adapterId, bytes32 indexed messageId, bytes reason);
	```

- Found in contracts/bridge/BridgeRouter.sol [Line: 16](contracts/bridge/BridgeRouter.sol#L16)

	```solidity
	    event MessageRetrySucceeded(uint16 adapterId, bytes32 indexed messageId);
	```

- Found in contracts/bridge/BridgeRouter.sol [Line: 17](contracts/bridge/BridgeRouter.sol#L17)

	```solidity
	    event MessageRetryFailed(uint16 adapterId, bytes32 indexed messageId, bytes reason);
	```

- Found in contracts/bridge/BridgeRouter.sol [Line: 18](contracts/bridge/BridgeRouter.sol#L18)

	```solidity
	    event MessageReverseSucceeded(uint16 adapterId, bytes32 indexed messageId);
	```

- Found in contracts/bridge/BridgeRouter.sol [Line: 19](contracts/bridge/BridgeRouter.sol#L19)

	```solidity
	    event MessageReverseFailed(uint16 adapterId, bytes32 indexed messageId, bytes reason);
	```

- Found in contracts/bridge/BridgeRouter.sol [Line: 20](contracts/bridge/BridgeRouter.sol#L20)

	```solidity
	    event Withdraw(bytes32 userId, address receiver, uint256 amount);
	```

- Found in contracts/bridge/WormholeCCTPAdapter.sol [Line: 22](contracts/bridge/WormholeCCTPAdapter.sol#L22)

	```solidity
	    event ReceiveMessage(bytes32 indexed messageId, bytes32 adapterAddress);
	```

- Found in contracts/bridge/WormholeDataAdapter.sol [Line: 16](contracts/bridge/WormholeDataAdapter.sol#L16)

	```solidity
	    event ReceiveMessage(bytes32 indexed messageId, bytes32 adapterAddress);
	```

- Found in contracts/bridge/interfaces/IBridgeAdapter.sol [Line: 7](contracts/bridge/interfaces/IBridgeAdapter.sol#L7)

	```solidity
	    event SendMessage(bytes32 operationId, Messages.MessageToSend message);
	```

- Found in contracts/hub/OracleManager.sol [Line: 11](contracts/hub/OracleManager.sol#L11)

	```solidity
	    event NodeIdSetForPool(bytes32 nodeId, uint8 poolId);
	```

- Found in contracts/hub/OracleManager.sol [Line: 12](contracts/hub/OracleManager.sol#L12)

	```solidity
	    event NodeManagerSet(address nodeManager);
	```

- Found in contracts/hub/interfaces/IAccountManager.sol [Line: 26](contracts/hub/interfaces/IAccountManager.sol#L26)

	```solidity
	    event CreateAccount(bytes32 accountId, uint16 chainId, bytes32 addr, bytes32 indexed refAccountId);
	```

- Found in contracts/hub/interfaces/IAccountManager.sol [Line: 33](contracts/hub/interfaces/IAccountManager.sol#L33)

	```solidity
	    event AcceptInviteAddress(bytes32 accountId, uint16 chainId, bytes32 addr);
	```

- Found in contracts/hub/interfaces/IAccountManager.sol [Line: 34](contracts/hub/interfaces/IAccountManager.sol#L34)

	```solidity
	    event UnregisterAddress(bytes32 accountId, uint16 unregisterChainId, bytes32 unregisterAddr);
	```

- Found in contracts/hub/interfaces/IAccountManager.sol [Line: 35](contracts/hub/interfaces/IAccountManager.sol#L35)

	```solidity
	    event AddDelegate(bytes32 accountId, address indexed addr);
	```

- Found in contracts/hub/interfaces/IAccountManager.sol [Line: 36](contracts/hub/interfaces/IAccountManager.sol#L36)

	```solidity
	    event RemoveDelegate(bytes32 accountId, address indexed addr);
	```

- Found in contracts/hub/interfaces/IHubPool.sol [Line: 10](contracts/hub/interfaces/IHubPool.sol#L10)

	```solidity
	    event ClearTokenFees(uint256 amount);
	```

- Found in contracts/hub/interfaces/ILoanManager.sol [Line: 16](contracts/hub/interfaces/ILoanManager.sol#L16)

	```solidity
	    event CreateUserLoan(bytes32 loanId, bytes32 indexed accountId, uint16 loanTypeId, bytes32 loanName);
	```

- Found in contracts/hub/interfaces/ILoanManager.sol [Line: 17](contracts/hub/interfaces/ILoanManager.sol#L17)

	```solidity
	    event DeleteUserLoan(bytes32 loanId, bytes32 indexed accountId);
	```

- Found in contracts/hub/logic/HubPoolLogic.sol [Line: 11](contracts/hub/logic/HubPoolLogic.sol#L11)

	```solidity
	    event InterestIndexesUpdated(
	```

- Found in contracts/hub/logic/HubPoolLogic.sol [Line: 16](contracts/hub/logic/HubPoolLogic.sol#L16)

	```solidity
	    event InterestRatesUpdated(
	```

- Found in contracts/hub/logic/LoanManagerLogic.sol [Line: 33](contracts/hub/logic/LoanManagerLogic.sol#L33)

	```solidity
	    event Deposit(bytes32 loanId, uint8 poolId, uint256 amount, uint256 fAmount);
	```

- Found in contracts/hub/logic/LoanManagerLogic.sol [Line: 34](contracts/hub/logic/LoanManagerLogic.sol#L34)

	```solidity
	    event DepositFToken(bytes32 loanId, uint8 poolId, uint256 fAmount);
	```

- Found in contracts/hub/logic/LoanManagerLogic.sol [Line: 35](contracts/hub/logic/LoanManagerLogic.sol#L35)

	```solidity
	    event Withdraw(bytes32 loanId, uint8 poolId, uint256 amount, uint256 fAmount);
	```

- Found in contracts/hub/logic/LoanManagerLogic.sol [Line: 36](contracts/hub/logic/LoanManagerLogic.sol#L36)

	```solidity
	    event WithdrawFToken(bytes32 loanId, uint8 poolId, uint256 fAmount);
	```

- Found in contracts/hub/logic/LoanManagerLogic.sol [Line: 37](contracts/hub/logic/LoanManagerLogic.sol#L37)

	```solidity
	    event Borrow(bytes32 loanId, uint8 poolId, uint256 amount, bool isStableBorrow, uint256 stableInterestRate);
	```

- Found in contracts/hub/logic/LoanManagerLogic.sol [Line: 38](contracts/hub/logic/LoanManagerLogic.sol#L38)

	```solidity
	    event Repay(bytes32 loanId, uint8 poolId, uint256 principalPaid, uint256 interestPaid, uint256 excessPaid);
	```

- Found in contracts/hub/logic/LoanManagerLogic.sol [Line: 39](contracts/hub/logic/LoanManagerLogic.sol#L39)

	```solidity
	    event RepayWithCollateral(
	```

- Found in contracts/hub/logic/LoanManagerLogic.sol [Line: 46](contracts/hub/logic/LoanManagerLogic.sol#L46)

	```solidity
	    event Liquidate(
	```

- Found in contracts/hub/logic/LoanManagerLogic.sol [Line: 55](contracts/hub/logic/LoanManagerLogic.sol#L55)

	```solidity
	    event SwitchBorrowType(bytes32 loanId, uint8 poolId);
	```

- Found in contracts/hub/logic/LoanManagerLogic.sol [Line: 56](contracts/hub/logic/LoanManagerLogic.sol#L56)

	```solidity
	    event RebalanceUp(bytes32 loanId, uint8 poolId, uint256 stableInterestRate);
	```

- Found in contracts/hub/logic/LoanManagerLogic.sol [Line: 57](contracts/hub/logic/LoanManagerLogic.sol#L57)

	```solidity
	    event RebalanceDown(bytes32 loanId, uint8 poolId, uint256 stableInterestRate);
	```

- Found in contracts/hub/logic/RewardLogic.sol [Line: 13](contracts/hub/logic/RewardLogic.sol#L13)

	```solidity
	    event RewardIndexesUpdated(
	```

- Found in contracts/oracle/interfaces/INodeManager.sol [Line: 15](contracts/oracle/interfaces/INodeManager.sol#L15)

	```solidity
	    event NodeRegistered(bytes32 nodeId, NodeDefinition.NodeType nodeType, bytes parameters, bytes32[] parents);
	```

- Found in contracts/spoke/RateLimited.sol [Line: 16](contracts/spoke/RateLimited.sol#L16)

	```solidity
	    event PeriodUpdated(uint256 periodNumber, uint256 capacity);
	```

- Found in contracts/spoke/RateLimited.sol [Line: 17](contracts/spoke/RateLimited.sol#L17)

	```solidity
	    event CapacityIncreased(uint256 periodNumber, uint256 amount, uint256 newCapacity);
	```

- Found in contracts/spoke/RateLimited.sol [Line: 18](contracts/spoke/RateLimited.sol#L18)

	```solidity
	    event CapacityDecreased(uint256 periodNumber, uint256 amount, uint256 newCapacity);
	```



## NC-5: The `nonReentrant` `modifier` should occur before all other modifiers

This is a best-practice to protect against reentrancy in other modifiers

- Found in contracts/bridge/BridgeMessenger.sol [Line: 25](contracts/bridge/BridgeMessenger.sol#L25)

	```solidity
	    function receiveMessage(Messages.MessageReceived memory message) external virtual onlyRouter nonReentrant {
	```

- Found in contracts/bridge/BridgeMessenger.sol [Line: 32](contracts/bridge/BridgeMessenger.sol#L32)

	```solidity
	    ) external virtual onlyRouter nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 58](contracts/hub/HubPool.sol#L58)

	```solidity
	    function clearTokenFees() external override onlyRole(HUB_ROLE) nonReentrant returns (uint256) {
	```

- Found in contracts/hub/HubPool.sol [Line: 81](contracts/hub/HubPool.sol#L81)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant returns (Messages.MessageToSend memory) {
	```

- Found in contracts/hub/HubPool.sol [Line: 129](contracts/hub/HubPool.sol#L129)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant returns (DataTypes.DepositPoolParams memory) {
	```

- Found in contracts/hub/HubPool.sol [Line: 137](contracts/hub/HubPool.sol#L137)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant returns (DataTypes.WithdrawPoolParams memory) {
	```

- Found in contracts/hub/HubPool.sol [Line: 152](contracts/hub/HubPool.sol#L152)

	```solidity
	        nonReentrant
	```

- Found in contracts/hub/HubPool.sol [Line: 162](contracts/hub/HubPool.sol#L162)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 170](contracts/hub/HubPool.sol#L170)

	```solidity
	        nonReentrant
	```

- Found in contracts/hub/HubPool.sol [Line: 181](contracts/hub/HubPool.sol#L181)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 193](contracts/hub/HubPool.sol#L193)

	```solidity
	        nonReentrant
	```

- Found in contracts/hub/HubPool.sol [Line: 199](contracts/hub/HubPool.sol#L199)

	```solidity
	    function updatePoolWithLiquidation() external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 210](contracts/hub/HubPool.sol#L210)

	```solidity
	        nonReentrant
	```

- Found in contracts/hub/HubPool.sol [Line: 220](contracts/hub/HubPool.sol#L220)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 233](contracts/hub/HubPool.sol#L233)

	```solidity
	        nonReentrant
	```

- Found in contracts/hub/HubPool.sol [Line: 242](contracts/hub/HubPool.sol#L242)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 250](contracts/hub/HubPool.sol#L250)

	```solidity
	        nonReentrant
	```

- Found in contracts/hub/HubPool.sol [Line: 259](contracts/hub/HubPool.sol#L259)

	```solidity
	    ) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 263](contracts/hub/HubPool.sol#L263)

	```solidity
	    function mintFTokenForFeeRecipient(uint256 amount) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 267](contracts/hub/HubPool.sol#L267)

	```solidity
	    function mintFToken(address recipient, uint256 amount) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/HubPool.sol [Line: 271](contracts/hub/HubPool.sol#L271)

	```solidity
	    function burnFToken(address sender, uint256 amount) external override onlyRole(LOAN_MANAGER_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 45](contracts/hub/LoanManager.sol#L45)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 60](contracts/hub/LoanManager.sol#L60)

	```solidity
	    function deleteUserLoan(bytes32 loanId, bytes32 accountId) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 79](contracts/hub/LoanManager.sol#L79)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 98](contracts/hub/LoanManager.sol#L98)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 118](contracts/hub/LoanManager.sol#L118)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant returns (uint256 underlingAmount) {
	```

- Found in contracts/hub/LoanManager.sol [Line: 144](contracts/hub/LoanManager.sol#L144)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 169](contracts/hub/LoanManager.sol#L169)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 194](contracts/hub/LoanManager.sol#L194)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 217](contracts/hub/LoanManager.sol#L217)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 241](contracts/hub/LoanManager.sol#L241)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```

- Found in contracts/hub/LoanManager.sol [Line: 271](contracts/hub/LoanManager.sol#L271)

	```solidity
	    ) external override onlyRole(HUB_ROLE) nonReentrant {
	```



